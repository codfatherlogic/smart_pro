var k=(j,v,g)=>new Promise((_,p)=>{var y=c=>{try{m(g.next(c))}catch(i){p(i)}},h=c=>{try{m(g.throw(c))}catch(i){p(i)}},m=c=>c.done?_(c.value):Promise.resolve(c.value).then(y,h);m((g=g.apply(j,v)).next())});import{o as W,j as q,k as U,l as Q,m as G,n as x,d as b,s as J,q as K,r as X,u as Z,v as tt,w as et,x as st,y as at,i as ot}from"./index-BtvF1KL1.js";import{f as nt,r as f,L as M,a as lt,A as it,t as o,z as P,M as rt,i as dt,l,q as r,n,v as I,y as u,k as d,N as ct,x as t,F as S,O as $,P as A,Q as ut}from"./frappe-ui-5f3Xtay5.js";const pt={key:0,class:"notification-badge"},mt={class:"p-4"},vt={class:"grid grid-cols-2 gap-4 mb-6"},ft={class:"app-card p-4"},gt={class:"text-3xl font-bold text-primary-500"},_t={class:"app-card p-4"},yt={class:"text-3xl font-bold text-orange-500"},ht={class:"app-card mb-6"},kt={class:"app-card-header flex justify-between items-center"},xt={key:0,class:"p-4"},bt={key:1,class:"empty-state py-8"},Ct={key:2},wt=["onClick"],It={class:"flex-1"},jt={class:"font-medium text-gray-800"},Tt={class:"text-sm text-gray-500"},Lt={class:"flex items-center justify-between"},Nt={class:"flex items-center"},Dt={class:"w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center mr-3"},Rt={class:"app-card"},Mt={class:"app-card-header flex justify-between items-center"},Pt={key:0,class:"p-4"},St={key:1,class:"empty-state py-8"},$t={key:2},At=["onClick"],Ot={class:"flex-1"},Bt={class:"font-medium text-gray-800"},Et={class:"text-sm text-gray-500"},Ht={class:"progress-bar mt-2"},Vt=3e4,zt={__name:"Home",setup(j){const v=rt(),g=dt("$dayjs"),_=f(!0),p=f([]),y=f([]),h=f({projects:0,tasks:0}),m=f(0),c=f("Smart Pro"),i=f(!1),T=M({url:"smart_pro.smart_pro.api.projects.get_user_projects",auto:!1}),L=M({url:"smart_pro.smart_pro.api.projects.get_user_tasks",auto:!1});let C=0;function w(s=!1){return k(this,null,function*(){const e=Date.now();if(!(!s&&C&&e-C<Vt&&p.value.length>0)){_.value=p.value.length===0;try{yield Promise.all([T.fetch(),L.fetch()]),p.value=T.data||[],y.value=L.data||[],h.value={projects:p.value.filter(a=>a.status==="Active").length,tasks:y.value.filter(a=>a.status!=="Completed").length},C=e}catch(a){console.error("Error loading data:",a)}finally{_.value=!1}}})}function O(s){w(!0).finally(()=>{s.target.complete()})}function N(s){return s?g(s).format("MMM D, YYYY"):"-"}function D(s){return{Active:"active",Planning:"planning",Completed:"completed","On Hold":"on-hold",Cancelled:"cancelled",Open:"planning",Working:"on-hold"}[s]||""}function B(s){v.push(`/smart-pro/project/${encodeURIComponent(s)}`)}function E(s){v.push(`/smart-pro/task/${encodeURIComponent(s)}`)}function H(){v.push("/smart-pro/notifications")}function R(){return k(this,null,function*(){try{const s=yield P("frappe.client.get_count",{doctype:"Notification Log",filters:{for_user:["like","%"],read:0}});m.value=s||0}catch(s){console.error("Error loading notification count:",s),m.value=0}})}function V(){return k(this,null,function*(){try{const s=yield P("smart_pro.smart_pro.api.projects.get_app_settings");s&&s.app_name&&(c.value=s.app_name)}catch(s){console.error("Error loading app settings:",s)}})}function z(){const s=localStorage.getItem("smart-pro-theme");if(s==="dark")i.value=!0,document.body.classList.add("dark"),document.body.classList.remove("light");else if(s==="light")i.value=!1,document.body.classList.add("light"),document.body.classList.remove("dark");else{const e=window.matchMedia("(prefers-color-scheme: dark)").matches;i.value=e}}function Y(){i.value=!i.value,i.value?(document.body.classList.add("dark"),document.body.classList.remove("light"),localStorage.setItem("smart-pro-theme","dark")):(document.body.classList.remove("dark"),document.body.classList.add("light"),localStorage.setItem("smart-pro-theme","light"))}return lt(()=>{z(),V(),w(),R()}),W(()=>{w(),R()}),(s,e)=>(l(),it(o(ot),null,{default:r(()=>[n(o(q),null,{default:r(()=>[n(o(U),null,{default:r(()=>[n(o(Q),null,{default:r(()=>[I(u(c.value),1)]),_:1}),n(o(G),{slot:"end"},{default:r(()=>[n(o(x),{onClick:Y,class:"theme-btn"},{default:r(()=>[n(o(b),{icon:i.value?o(J):o(K)},null,8,["icon"])]),_:1}),n(o(x),{onClick:H,class:"notification-btn"},{default:r(()=>[n(o(b),{icon:o(X)},null,8,["icon"]),m.value>0?(l(),d("span",pt,u(m.value>9?"9+":m.value),1)):ct("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),n(o(Z),{fullscreen:!0},{default:r(()=>[n(o(tt),{slot:"fixed",onIonRefresh:O},{default:r(()=>[n(o(et))]),_:1}),t("div",mt,[e[14]||(e[14]=t("div",{class:"mb-6"},[t("h1",{class:"text-2xl font-bold text-gray-800"}," Welcome back! "),t("p",{class:"text-gray-500"}," Here's your overview ")],-1)),t("div",vt,[t("div",ft,[t("div",gt,u(h.value.projects),1),e[3]||(e[3]=t("div",{class:"text-sm text-gray-500"}," Active Projects ",-1))]),t("div",_t,[t("div",yt,u(h.value.tasks),1),e[4]||(e[4]=t("div",{class:"text-sm text-gray-500"}," Pending Tasks ",-1))])]),t("div",ht,[t("div",kt,[e[6]||(e[6]=t("span",null,"Recent Projects",-1)),n(o(x),{fill:"clear",size:"small",onClick:e[0]||(e[0]=a=>o(v).push("/smart-pro/projects"))},{default:r(()=>[...e[5]||(e[5]=[I(" See All ",-1)])]),_:1})]),_.value?(l(),d("div",xt,[...e[7]||(e[7]=[t("div",{class:"skeleton h-16 mb-3"},null,-1),t("div",{class:"skeleton h-16 mb-3"},null,-1)])])):p.value.length===0?(l(),d("div",bt,[...e[8]||(e[8]=[t("div",{class:"empty-state-title"}," No projects yet ",-1),t("div",{class:"empty-state-description"}," Create your first project to get started ",-1)])])):(l(),d("div",Ct,[(l(!0),d(S,null,$(p.value.slice(0,3),a=>(l(),d("div",{key:a.name,class:"app-list-item",onClick:F=>B(a.name)},[t("div",It,[t("div",jt,u(a.title||a.name),1),t("div",Tt,u(N(a.end_date)),1)]),t("span",{class:A(["status-badge",D(a.status)])},u(a.status),3)],8,wt))),128))]))]),t("div",{class:"app-card mb-6 p-4 cursor-pointer",onClick:e[1]||(e[1]=a=>o(v).push("/smart-pro/connections"))},[t("div",Lt,[t("div",Nt,[t("div",Dt,[n(o(b),{icon:o(st),class:"text-xl text-purple-600"},null,8,["icon"])]),e[9]||(e[9]=t("div",null,[t("div",{class:"font-semibold text-gray-800"},"Connections Dashboard"),t("div",{class:"text-sm text-gray-500"},"View all doctypes & relationships")],-1))]),n(o(b),{icon:o(at),class:"text-gray-400"},null,8,["icon"])])]),t("div",Rt,[t("div",Mt,[e[11]||(e[11]=t("span",null,"My Tasks",-1)),n(o(x),{fill:"clear",size:"small",onClick:e[2]||(e[2]=a=>o(v).push("/smart-pro/tasks"))},{default:r(()=>[...e[10]||(e[10]=[I(" See All ",-1)])]),_:1})]),_.value?(l(),d("div",Pt,[...e[12]||(e[12]=[t("div",{class:"skeleton h-16 mb-3"},null,-1),t("div",{class:"skeleton h-16 mb-3"},null,-1)])])):y.value.length===0?(l(),d("div",St,[...e[13]||(e[13]=[t("div",{class:"empty-state-title"}," No tasks assigned ",-1),t("div",{class:"empty-state-description"}," Tasks assigned to you will appear here ",-1)])])):(l(),d("div",$t,[(l(!0),d(S,null,$(y.value.slice(0,3),a=>(l(),d("div",{key:a.name,class:"app-list-item",onClick:F=>E(a.name)},[t("div",Ot,[t("div",Bt,u(a.title||a.name),1),t("div",Et," Due: "+u(N(a.due_date)),1),t("div",Ht,[t("div",{class:"progress-bar-fill",style:ut({width:(a.progress||0)+"%"})},null,4)])]),t("span",{class:A(["status-badge",D(a.status)])},u(a.status),3)],8,At))),128))]))])])]),_:1})]),_:1}))}},qt=nt(zt,[["__scopeId","data-v-63af2711"]]);export{qt as default};
//# sourceMappingURL=Home-CHnpFJJY.js.map
