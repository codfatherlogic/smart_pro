var k=(j,m,_)=>new Promise((g,v)=>{var y=c=>{try{p(_.next(c))}catch(r){v(r)}},h=c=>{try{p(_.throw(c))}catch(r){v(r)}},p=c=>c.done?g(c.value):Promise.resolve(c.value).then(y,h);p((_=_.apply(j,m)).next())});import{f as F,r as f,L as T,a as q,A as U,t as a,z as D,M as W,i as Q,l,q as i,n,v as C,y as u,k as d,N as G,x as t,F as M,O as P,P as S,Q as J}from"./frappe-ui-5f3Xtay5.js";import{j as K,k as X,l as Z,m as tt,n as x,d as b,s as st,o as et,q as at,r as ot,u as nt,v as lt,w as it,x as rt,i as dt}from"./index-DT4P12y0.js";const ct={key:0,class:"notification-badge"},ut={class:"p-4"},pt={class:"grid grid-cols-2 gap-4 mb-6"},mt={class:"app-card p-4"},vt={class:"text-3xl font-bold text-primary-500"},ft={class:"app-card p-4"},_t={class:"text-3xl font-bold text-orange-500"},gt={class:"app-card mb-6"},yt={class:"app-card-header flex justify-between items-center"},ht={key:0,class:"p-4"},kt={key:1,class:"empty-state py-8"},xt={key:2},bt=["onClick"],Ct={class:"flex-1"},jt={class:"font-medium text-gray-800"},It={class:"text-sm text-gray-500"},wt={class:"flex items-center justify-between"},Nt={class:"flex items-center"},Lt={class:"w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center mr-3"},Rt={class:"app-card"},Tt={class:"app-card-header flex justify-between items-center"},Dt={key:0,class:"p-4"},Mt={key:1,class:"empty-state py-8"},Pt={key:2},St=["onClick"],$t={class:"flex-1"},Ot={class:"font-medium text-gray-800"},At={class:"text-sm text-gray-500"},Bt={class:"progress-bar mt-2"},zt={__name:"Home",setup(j){const m=W(),_=Q("$dayjs"),g=f(!0),v=f([]),y=f([]),h=f({projects:0,tasks:0}),p=f(0),c=f("Smart Pro"),r=f(!1),I=T({url:"smart_pro.smart_pro.api.projects.get_user_projects",auto:!1}),w=T({url:"smart_pro.smart_pro.api.projects.get_user_tasks",auto:!1});function N(){return k(this,null,function*(){g.value=!0;try{yield Promise.all([I.fetch(),w.fetch()]),v.value=I.data||[],y.value=w.data||[],h.value={projects:v.value.filter(e=>e.status==="Active").length,tasks:y.value.filter(e=>e.status!=="Completed").length}}catch(e){console.error("Error loading data:",e)}finally{g.value=!1}})}function $(e){N().finally(()=>{e.target.complete()})}function L(e){return e?_(e).format("MMM D, YYYY"):"-"}function R(e){return{Active:"active",Planning:"planning",Completed:"completed","On Hold":"on-hold",Cancelled:"cancelled",Open:"planning",Working:"on-hold"}[e]||""}function O(e){m.push(`/smart-pro/project/${encodeURIComponent(e)}`)}function A(e){m.push(`/smart-pro/task/${encodeURIComponent(e)}`)}function B(){m.push("/smart-pro/notifications")}function z(){return k(this,null,function*(){try{const e=yield D("frappe.client.get_count",{doctype:"Notification Log",filters:{for_user:["like","%"],read:0}});p.value=e||0}catch(e){console.error("Error loading notification count:",e),p.value=0}})}function H(){return k(this,null,function*(){try{const e=yield D("smart_pro.smart_pro.api.projects.get_app_settings");e&&e.app_name&&(c.value=e.app_name)}catch(e){console.error("Error loading app settings:",e)}})}function V(){const e=localStorage.getItem("smart-pro-theme");if(e==="dark")r.value=!0,document.body.classList.add("dark"),document.body.classList.remove("light");else if(e==="light")r.value=!1,document.body.classList.add("light"),document.body.classList.remove("dark");else{const s=window.matchMedia("(prefers-color-scheme: dark)").matches;r.value=s}}function E(){r.value=!r.value,r.value?(document.body.classList.add("dark"),document.body.classList.remove("light"),localStorage.setItem("smart-pro-theme","dark")):(document.body.classList.remove("dark"),document.body.classList.add("light"),localStorage.setItem("smart-pro-theme","light"))}return q(()=>{V(),H(),N(),z()}),(e,s)=>(l(),U(a(dt),null,{default:i(()=>[n(a(K),null,{default:i(()=>[n(a(X),null,{default:i(()=>[n(a(Z),null,{default:i(()=>[C(u(c.value),1)]),_:1}),n(a(tt),{slot:"end"},{default:i(()=>[n(a(x),{onClick:E,class:"theme-btn"},{default:i(()=>[n(a(b),{icon:r.value?a(st):a(et)},null,8,["icon"])]),_:1}),n(a(x),{onClick:B,class:"notification-btn"},{default:i(()=>[n(a(b),{icon:a(at)},null,8,["icon"]),p.value>0?(l(),d("span",ct,u(p.value>9?"9+":p.value),1)):G("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),n(a(ot),{fullscreen:!0},{fixed:i(()=>[n(a(it),{onIonRefresh:$},{default:i(()=>[n(a(rt))]),_:1})]),default:i(()=>[t("div",ut,[s[14]||(s[14]=t("div",{class:"mb-6"},[t("h1",{class:"text-2xl font-bold text-gray-800"}," Welcome back! "),t("p",{class:"text-gray-500"}," Here's your overview ")],-1)),t("div",pt,[t("div",mt,[t("div",vt,u(h.value.projects),1),s[3]||(s[3]=t("div",{class:"text-sm text-gray-500"}," Active Projects ",-1))]),t("div",ft,[t("div",_t,u(h.value.tasks),1),s[4]||(s[4]=t("div",{class:"text-sm text-gray-500"}," Pending Tasks ",-1))])]),t("div",gt,[t("div",yt,[s[6]||(s[6]=t("span",null,"Recent Projects",-1)),n(a(x),{fill:"clear",size:"small",onClick:s[0]||(s[0]=o=>a(m).push("/smart-pro/projects"))},{default:i(()=>[...s[5]||(s[5]=[C(" See All ",-1)])]),_:1})]),g.value?(l(),d("div",ht,[...s[7]||(s[7]=[t("div",{class:"skeleton h-16 mb-3"},null,-1),t("div",{class:"skeleton h-16 mb-3"},null,-1)])])):v.value.length===0?(l(),d("div",kt,[...s[8]||(s[8]=[t("div",{class:"empty-state-title"}," No projects yet ",-1),t("div",{class:"empty-state-description"}," Create your first project to get started ",-1)])])):(l(),d("div",xt,[(l(!0),d(M,null,P(v.value.slice(0,3),o=>(l(),d("div",{key:o.name,class:"app-list-item",onClick:Y=>O(o.name)},[t("div",Ct,[t("div",jt,u(o.title||o.name),1),t("div",It,u(L(o.end_date)),1)]),t("span",{class:S(["status-badge",R(o.status)])},u(o.status),3)],8,bt))),128))]))]),t("div",{class:"app-card mb-6 p-4 cursor-pointer",onClick:s[1]||(s[1]=o=>a(m).push("/smart-pro/connections"))},[t("div",wt,[t("div",Nt,[t("div",Lt,[n(a(b),{icon:a(nt),class:"text-xl text-purple-600"},null,8,["icon"])]),s[9]||(s[9]=t("div",null,[t("div",{class:"font-semibold text-gray-800"},"Connections Dashboard"),t("div",{class:"text-sm text-gray-500"},"View all doctypes & relationships")],-1))]),n(a(b),{icon:a(lt),class:"text-gray-400"},null,8,["icon"])])]),t("div",Rt,[t("div",Tt,[s[11]||(s[11]=t("span",null,"My Tasks",-1)),n(a(x),{fill:"clear",size:"small",onClick:s[2]||(s[2]=o=>a(m).push("/smart-pro/tasks"))},{default:i(()=>[...s[10]||(s[10]=[C(" See All ",-1)])]),_:1})]),g.value?(l(),d("div",Dt,[...s[12]||(s[12]=[t("div",{class:"skeleton h-16 mb-3"},null,-1),t("div",{class:"skeleton h-16 mb-3"},null,-1)])])):y.value.length===0?(l(),d("div",Mt,[...s[13]||(s[13]=[t("div",{class:"empty-state-title"}," No tasks assigned ",-1),t("div",{class:"empty-state-description"}," Tasks assigned to you will appear here ",-1)])])):(l(),d("div",Pt,[(l(!0),d(M,null,P(y.value.slice(0,3),o=>(l(),d("div",{key:o.name,class:"app-list-item",onClick:Y=>A(o.name)},[t("div",$t,[t("div",Ot,u(o.title||o.name),1),t("div",At," Due: "+u(L(o.due_date)),1),t("div",Bt,[t("div",{class:"progress-bar-fill",style:J({width:(o.progress||0)+"%"})},null,4)])]),t("span",{class:S(["status-badge",R(o.status)])},u(o.status),3)],8,St))),128))]))])])]),_:1})]),_:1}))}},Yt=F(zt,[["__scopeId","data-v-b9fcda68"]]);export{Yt as default};
//# sourceMappingURL=Home-DxCFjbXc.js.map
