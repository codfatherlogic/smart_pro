{"version":3,"file":"Login-ChrWYBSR.js","sources":["../../../frontend/src/views/Login.vue"],"sourcesContent":["<template>\n  <ion-page>\n    <ion-content\n      :fullscreen=\"true\"\n      class=\"ion-padding login-content\"\n    >\n      <div class=\"flex flex-col items-center justify-center min-h-full\">\n        <!-- Logo -->\n        <div class=\"mb-8 text-center\">\n          <div\n            class=\"w-20 h-20 rounded-2xl bg-primary-500 flex items-center justify-center mx-auto mb-4 logo-container\"\n          >\n            <span class=\"text-3xl font-bold text-white\">SP</span>\n          </div>\n          <h1 class=\"text-2xl font-bold title-text\">\n            Smart Pro\n          </h1>\n          <p class=\"subtitle-text\">\n            Project Management\n          </p>\n        </div>\n\n        <!-- Login Form -->\n        <div class=\"w-full max-w-sm\">\n          <div class=\"login-card p-6\">\n            <form @submit.prevent=\"handleLogin\">\n              <div class=\"mb-4\">\n                <ion-input\n                  v-model=\"email\"\n                  type=\"email\"\n                  placeholder=\"Email\"\n                  fill=\"outline\"\n                  :disabled=\"loading\"\n                  class=\"login-input\"\n                  required\n                />\n              </div>\n\n              <div class=\"mb-6\">\n                <ion-input\n                  v-model=\"password\"\n                  type=\"password\"\n                  placeholder=\"Password\"\n                  fill=\"outline\"\n                  :disabled=\"loading\"\n                  class=\"login-input\"\n                  required\n                />\n              </div>\n\n              <ion-button\n                expand=\"block\"\n                type=\"submit\"\n                :disabled=\"loading || !email || !password\"\n                class=\"login-button\"\n              >\n                <ion-spinner\n                  v-if=\"loading\"\n                  name=\"crescent\"\n                  class=\"mr-2\"\n                />\n                {{ loading ? \"Signing in...\" : \"Sign In\" }}\n              </ion-button>\n            </form>\n\n            <div\n              v-if=\"error\"\n              class=\"mt-4 p-3 error-message rounded-lg text-sm\"\n            >\n              {{ error }}\n            </div>\n\n            <!-- Social Login Divider -->\n            <div\n              v-if=\"socialProviders.length > 0\"\n              class=\"divider-container my-6\"\n            >\n              <div class=\"divider-line\" />\n              <span class=\"divider-text\">or continue with</span>\n              <div class=\"divider-line\" />\n            </div>\n\n            <!-- Social Login Buttons -->\n            <div\n              v-if=\"socialProviders.length > 0\"\n              class=\"social-login-container\"\n            >\n              <button\n                v-for=\"provider in socialProviders\"\n                :key=\"provider.name\"\n                type=\"button\"\n                class=\"social-login-btn\"\n                :style=\"{ '--provider-color': provider.color }\"\n                @click=\"handleSocialLogin(provider)\"\n                :disabled=\"loading\"\n              >\n                <ion-icon :icon=\"getProviderIcon(provider.icon)\" />\n                <span>{{ provider.label }}</span>\n              </button>\n            </div>\n\n            <!-- Loading social providers -->\n            <div\n              v-if=\"loadingProviders\"\n              class=\"text-center py-4\"\n            >\n              <ion-spinner name=\"dots\" class=\"social-spinner\" />\n            </div>\n          </div>\n\n          <div class=\"text-center mt-6 text-sm\">\n            <a\n              href=\"/login#forgot\"\n              class=\"forgot-link\"\n            >Forgot Password?</a>\n          </div>\n\n          <!-- Theme Toggle -->\n          <div class=\"text-center mt-4\">\n            <ion-button\n              fill=\"clear\"\n              size=\"small\"\n              @click=\"toggleDarkMode\"\n              class=\"theme-toggle-btn\"\n            >\n              <ion-icon :icon=\"isDarkMode ? sunnyOutline : moonOutline\" slot=\"start\" />\n              {{ isDarkMode ? 'Light Mode' : 'Dark Mode' }}\n            </ion-button>\n          </div>\n        </div>\n      </div>\n    </ion-content>\n  </ion-page>\n</template>\n\n<script setup>\nimport { ref, onMounted } from \"vue\"\nimport { useRouter } from \"vue-router\"\nimport { IonPage, IonContent, IonInput, IonButton, IonSpinner, IonIcon } from \"@ionic/vue\"\nimport {\n  logoGoogle,\n  logoGithub,\n  logoFacebook,\n  logoMicrosoft,\n  globeOutline,\n  moonOutline,\n  sunnyOutline\n} from \"ionicons/icons\"\nimport { call } from \"frappe-ui\"\n\nconst router = useRouter()\n\nconst email = ref(\"\")\nconst password = ref(\"\")\nconst loading = ref(false)\nconst error = ref(\"\")\nconst socialProviders = ref([])\nconst loadingProviders = ref(true)\nconst isDarkMode = ref(false)\n\n// Icon mapping for social providers\nconst iconMap = {\n  \"logo-google\": logoGoogle,\n  \"logo-github\": logoGithub,\n  \"logo-facebook\": logoFacebook,\n  \"logo-microsoft\": logoMicrosoft,\n  \"globe-outline\": globeOutline\n}\n\nfunction getProviderIcon(iconName) {\n  return iconMap[iconName] || globeOutline\n}\n\nasync function loadSocialProviders() {\n  loadingProviders.value = true\n  try {\n    // Pass the redirect URL so OAuth returns to our app after login\n    const redirectTo = window.location.origin + \"/smart-pro/home\"\n    const result = await call(\"smart_pro.smart_pro.api.projects.get_social_login_providers\", {\n      redirect_to: redirectTo\n    })\n    if (result && result.success) {\n      socialProviders.value = result.providers || []\n    }\n  } catch (err) {\n    console.error(\"Error loading social providers:\", err)\n  } finally {\n    loadingProviders.value = false\n  }\n}\n\nasync function handleLogin() {\n  if (!email.value || !password.value) return\n\n  loading.value = true\n  error.value = \"\"\n\n  try {\n    await call(\"login\", {\n      usr: email.value,\n      pwd: password.value,\n    })\n\n    // Redirect to home on success\n    router.push(\"/smart-pro/home\")\n  } catch (err) {\n    console.error(\"Login error:\", err)\n    error.value = err.messages?.[0] || \"Invalid email or password\"\n  } finally {\n    loading.value = false\n  }\n}\n\nfunction handleSocialLogin(provider) {\n  // Redirect to the OAuth authorize URL (already contains all necessary parameters)\n  window.location.href = provider.url\n}\n\nfunction initDarkMode() {\n  // Check localStorage for user preference\n  const savedTheme = localStorage.getItem(\"smart-pro-theme\")\n  if (savedTheme === \"dark\") {\n    isDarkMode.value = true\n    document.body.classList.add(\"dark\")\n    document.body.classList.remove(\"light\")\n  } else if (savedTheme === \"light\") {\n    isDarkMode.value = false\n    document.body.classList.add(\"light\")\n    document.body.classList.remove(\"dark\")\n  } else {\n    // Check system preference\n    const prefersDark = window.matchMedia(\"(prefers-color-scheme: dark)\").matches\n    isDarkMode.value = prefersDark\n    if (prefersDark) {\n      document.body.classList.add(\"dark\")\n    }\n  }\n}\n\nfunction toggleDarkMode() {\n  isDarkMode.value = !isDarkMode.value\n  if (isDarkMode.value) {\n    document.body.classList.add(\"dark\")\n    document.body.classList.remove(\"light\")\n    localStorage.setItem(\"smart-pro-theme\", \"dark\")\n  } else {\n    document.body.classList.remove(\"dark\")\n    document.body.classList.add(\"light\")\n    localStorage.setItem(\"smart-pro-theme\", \"light\")\n  }\n}\n\nonMounted(() => {\n  initDarkMode()\n  loadSocialProviders()\n})\n</script>\n\n<style scoped>\n/* Light mode (default) */\n.login-content {\n  --background: linear-gradient(180deg, #f8fafc 0%, #e2e8f0 100%);\n}\n\n.title-text {\n  color: #1e293b;\n}\n\n.subtitle-text {\n  color: #64748b;\n}\n\n.login-card {\n  background: white;\n  border-radius: 1rem;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);\n}\n\n.login-input {\n  --background: #f8fafc;\n  --border-color: #e2e8f0;\n  --color: #1e293b;\n  --placeholder-color: #94a3b8;\n}\n\n.login-button {\n  --background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);\n  --box-shadow: 0 4px 14px rgba(59, 130, 246, 0.4);\n  font-weight: 600;\n}\n\n.error-message {\n  background-color: #fef2f2;\n  color: #dc2626;\n}\n\n.forgot-link {\n  color: #3b82f6;\n  text-decoration: none;\n}\n\n.forgot-link:hover {\n  text-decoration: underline;\n}\n\n.logo-container {\n  box-shadow: 0 8px 24px rgba(59, 130, 246, 0.3);\n}\n\n/* Divider */\n.divider-container {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n}\n\n.divider-line {\n  flex: 1;\n  height: 1px;\n  background: #e2e8f0;\n}\n\n.divider-text {\n  color: #94a3b8;\n  font-size: 0.875rem;\n  white-space: nowrap;\n}\n\n/* Social Login Buttons */\n.social-login-container {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n\n.social-login-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.75rem;\n  padding: 0.875rem 1rem;\n  border: 1px solid #e2e8f0;\n  border-radius: 0.75rem;\n  background: white;\n  color: #374151;\n  font-size: 0.9375rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.social-login-btn:hover {\n  background: #f8fafc;\n  border-color: var(--provider-color);\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n}\n\n.social-login-btn:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.social-login-btn ion-icon {\n  font-size: 1.25rem;\n  color: var(--provider-color);\n}\n\n.social-spinner {\n  color: #64748b;\n}\n\n.theme-toggle-btn {\n  --color: #64748b;\n  font-size: 0.875rem;\n}\n\n/* Dark mode styles */\nbody.dark .login-content {\n  --background: linear-gradient(180deg, #0f172a 0%, #1e293b 100%);\n}\n\nbody.dark .title-text {\n  color: #f1f5f9;\n}\n\nbody.dark .subtitle-text {\n  color: #94a3b8;\n}\n\nbody.dark .login-card {\n  background: #1e293b;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n}\n\nbody.dark .login-input {\n  --background: #0f172a;\n  --border-color: #334155;\n  --color: #f1f5f9;\n  --placeholder-color: #64748b;\n}\n\nbody.dark .error-message {\n  background-color: rgba(220, 38, 38, 0.2);\n  color: #fca5a5;\n}\n\nbody.dark .divider-line {\n  background: #334155;\n}\n\nbody.dark .divider-text {\n  color: #64748b;\n}\n\nbody.dark .social-login-btn {\n  background: #0f172a;\n  border-color: #334155;\n  color: #e2e8f0;\n}\n\nbody.dark .social-login-btn:hover {\n  background: #1e293b;\n  border-color: var(--provider-color);\n}\n\nbody.dark .social-spinner {\n  color: #94a3b8;\n}\n\nbody.dark .forgot-link {\n  color: #60a5fa;\n}\n\nbody.dark .theme-toggle-btn {\n  --color: #94a3b8;\n}\n\nbody.dark .logo-container {\n  box-shadow: 0 8px 24px rgba(59, 130, 246, 0.2);\n}\n</style>\n"],"names":["router","useRouter","email","ref","password","loading","error","socialProviders","loadingProviders","isDarkMode","iconMap","logoGoogle","logoGithub","logoFacebook","logoMicrosoft","globeOutline","getProviderIcon","iconName","loadSocialProviders","__async","redirectTo","result","call","err","handleLogin","_a","handleSocialLogin","provider","initDarkMode","savedTheme","prefersDark","toggleDarkMode","onMounted","_createBlock","_unref","IonPage","_createVNode","IonContent","_createElementVNode","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","IonInput","$event","_hoisted_5","IonButton","IonSpinner","_createTextVNode","_createElementBlock","_hoisted_6","_toDisplayString","_openBlock","_hoisted_7","_cache","_hoisted_8","_Fragment","_renderList","_normalizeStyle","IonIcon","_hoisted_10","_hoisted_11","sunnyOutline","moonOutline"],"mappings":"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"}