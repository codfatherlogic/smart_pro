var u=(j,d,l)=>new Promise((p,x)=>{var v=n=>{try{f(l.next(n))}catch(g){x(g)}},y=n=>{try{f(l.throw(n))}catch(g){x(g)}},f=n=>n.done?p(n.value):Promise.resolve(n.value).then(v,y);f((l=l.apply(j,d)).next())});import{r as k,c as A,L as I,a as B,A as T,q as o,t,z as R,M as F,l as H,n as a,v as _,x as s,y as m}from"./frappe-ui-5f3Xtay5.js";import{o as N,j as V,k as E,m as K,z as U,l as z,u as D,a0 as M,a1 as h,e as w,d as c,y as C,a2 as q,a3 as W,Z,a4 as G,i as J,a5 as b,a6 as Q,a7 as S}from"./index-Cn4F0kH1.js";const X={class:"p-4"},Y={class:"app-card p-6 mb-6 text-center"},$={class:"w-20 h-20 rounded-full bg-primary-100 flex items-center justify-center mx-auto mb-4"},tt={class:"text-3xl font-bold text-primary-600"},et={class:"text-xl font-semibold text-gray-800"},at={class:"text-gray-500"},ot={class:"grid grid-cols-3 gap-4 mb-6"},st={class:"app-card p-4 text-center"},lt={class:"text-2xl font-bold text-primary-500"},nt={class:"app-card p-4 text-center"},rt={class:"text-2xl font-bold text-orange-500"},it={class:"app-card p-4 text-center"},ut={class:"text-2xl font-bold text-green-500"},ct={class:"app-card"},mt={__name:"Profile",setup(j){F();const d=k(""),l=k(""),p=k({projects:0,tasks:0,completed:0}),x=A(()=>d.value?d.value.split(" ").map(r=>r[0]).join("").toUpperCase().slice(0,2):"?"),v=I({url:"frappe.auth.get_logged_user",auto:!1}),y=I({url:"smart_pro.smart_pro.api.projects.get_user_projects",auto:!1}),f=I({url:"smart_pro.smart_pro.api.projects.get_user_tasks",auto:!1});function n(){return u(this,null,function*(){try{if(yield v.fetch(),l.value=v.data||"",l.value){const i=yield R("frappe.client.get_value",{doctype:"User",filters:{name:l.value},fieldname:"full_name"});d.value=(i==null?void 0:i.full_name)||l.value}yield Promise.all([y.fetch(),f.fetch()]);const r=y.data||[],e=f.data||[];p.value={projects:r.length,tasks:e.length,completed:e.filter(i=>i.status==="Completed").length}}catch(r){console.error("Error loading user data:",r)}})}function g(){return u(this,null,function*(){yield(yield b.create({header:"Settings",message:"Settings will be available in a future update.",buttons:["OK"]})).present()})}function O(){return u(this,null,function*(){yield(yield b.create({header:"Help & Support",message:"For support, please contact your administrator.",buttons:["OK"]})).present()})}function P(){return u(this,null,function*(){yield(yield b.create({header:"About Smart Pro",message:"Smart Pro is a project management application built on Frappe Framework.",buttons:["OK"]})).present()})}function L(){return u(this,null,function*(){yield(yield b.create({header:"Logout",message:"Are you sure you want to logout?",buttons:[{text:"Cancel",role:"cancel"},{text:"Logout",role:"destructive",handler:()=>u(this,null,function*(){const e=yield Q.create({message:"Logging out..."});yield e.present();try{yield fetch("/api/method/logout",{method:"POST",headers:{"Content-Type":"application/json"}}),S(),localStorage.removeItem("user_id"),sessionStorage.clear(),window.location.href="/smart-pro/login"}catch(i){console.error("Logout error:",i),S(),window.location.href="/smart-pro/login"}finally{yield e.dismiss()}})}]})).present()})}return B(()=>{n()}),N(()=>{n()}),(r,e)=>(H(),T(t(J),null,{default:o(()=>[a(t(V),null,{default:o(()=>[a(t(E),null,{default:o(()=>[a(t(K),{slot:"start"},{default:o(()=>[a(t(U),{"default-href":"/smart-pro/home",text:""})]),_:1}),a(t(z),null,{default:o(()=>[...e[0]||(e[0]=[_("Profile",-1)])]),_:1})]),_:1})]),_:1}),a(t(D),{fullscreen:!0},{default:o(()=>[s("div",X,[s("div",Y,[s("div",$,[s("span",tt,m(x.value),1)]),s("h2",et,m(d.value),1),s("p",at,m(l.value),1)]),s("div",ot,[s("div",st,[s("div",lt,m(p.value.projects),1),e[1]||(e[1]=s("div",{class:"text-xs text-gray-500"}," Projects ",-1))]),s("div",nt,[s("div",rt,m(p.value.tasks),1),e[2]||(e[2]=s("div",{class:"text-xs text-gray-500"}," Tasks ",-1))]),s("div",it,[s("div",ut,m(p.value.completed),1),e[3]||(e[3]=s("div",{class:"text-xs text-gray-500"}," Done ",-1))])]),s("div",ct,[a(t(M),{lines:"full"},{default:o(()=>[a(t(h),{button:"",onClick:g},{start:o(()=>[a(t(c),{icon:t(q)},null,8,["icon"])]),end:o(()=>[a(t(c),{icon:t(C)},null,8,["icon"])]),default:o(()=>[a(t(w),null,{default:o(()=>[...e[4]||(e[4]=[_("Settings",-1)])]),_:1})]),_:1}),a(t(h),{button:"",onClick:O},{start:o(()=>[a(t(c),{icon:t(W)},null,8,["icon"])]),end:o(()=>[a(t(c),{icon:t(C)},null,8,["icon"])]),default:o(()=>[a(t(w),null,{default:o(()=>[...e[5]||(e[5]=[_("Help & Support",-1)])]),_:1})]),_:1}),a(t(h),{button:"",onClick:P},{start:o(()=>[a(t(c),{icon:t(Z)},null,8,["icon"])]),end:o(()=>[a(t(c),{icon:t(C)},null,8,["icon"])]),default:o(()=>[a(t(w),null,{default:o(()=>[...e[6]||(e[6]=[_("About",-1)])]),_:1})]),_:1}),a(t(h),{button:"",class:"text-red-500",onClick:L},{default:o(()=>[a(t(c),{slot:"start",icon:t(G),color:"danger"},null,8,["icon"]),a(t(w),{color:"danger"},{default:o(()=>[...e[7]||(e[7]=[_(" Logout ",-1)])]),_:1})]),_:1})]),_:1})]),e[8]||(e[8]=s("div",{class:"text-center mt-6 text-sm text-gray-400"}," Smart Pro v1.0.0 ",-1))])]),_:1})]),_:1}))}};export{mt as default};
//# sourceMappingURL=Profile-BsnILOx1.js.map
