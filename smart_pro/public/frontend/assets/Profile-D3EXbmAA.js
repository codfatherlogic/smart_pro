var u=(C,d,l)=>new Promise((p,x)=>{var v=n=>{try{f(l.next(n))}catch(g){x(g)}},y=n=>{try{f(l.throw(n))}catch(g){x(g)}},f=n=>n.done?p(n.value):Promise.resolve(n.value).then(v,y);f((l=l.apply(C,d)).next())});import{r as k,c as L,L as I,a as T,A as B,q as o,t,z as A,M as R,l as F,n as a,v as _,x as s,y as m}from"./frappe-ui-5f3Xtay5.js";import{j as H,k as N,m as K,y as U,l as V,r as D,a2 as E,T as b,e as w,d as c,v as j,a3 as M,a4 as q,$ as z,a5 as $,i as G,a6 as h,a7 as J}from"./index-BT8PkI2H.js";const Q={class:"p-4"},W={class:"app-card p-6 mb-6 text-center"},X={class:"w-20 h-20 rounded-full bg-primary-100 flex items-center justify-center mx-auto mb-4"},Y={class:"text-3xl font-bold text-primary-600"},Z={class:"text-xl font-semibold text-gray-800"},tt={class:"text-gray-500"},et={class:"grid grid-cols-3 gap-4 mb-6"},at={class:"app-card p-4 text-center"},ot={class:"text-2xl font-bold text-primary-500"},st={class:"app-card p-4 text-center"},lt={class:"text-2xl font-bold text-orange-500"},rt={class:"app-card p-4 text-center"},nt={class:"text-2xl font-bold text-green-500"},it={class:"app-card"},pt={__name:"Profile",setup(C){R();const d=k(""),l=k(""),p=k({projects:0,tasks:0,completed:0}),x=L(()=>d.value?d.value.split(" ").map(r=>r[0]).join("").toUpperCase().slice(0,2):"?"),v=I({url:"frappe.auth.get_logged_user",auto:!1}),y=I({url:"smart_pro.smart_pro.api.projects.get_user_projects",auto:!1}),f=I({url:"smart_pro.smart_pro.api.projects.get_user_tasks",auto:!1});function n(){return u(this,null,function*(){try{if(yield v.fetch(),l.value=v.data||"",l.value){const i=yield A("frappe.client.get_value",{doctype:"User",filters:{name:l.value},fieldname:"full_name"});d.value=(i==null?void 0:i.full_name)||l.value}yield Promise.all([y.fetch(),f.fetch()]);const r=y.data||[],e=f.data||[];p.value={projects:r.length,tasks:e.length,completed:e.filter(i=>i.status==="Completed").length}}catch(r){console.error("Error loading user data:",r)}})}function g(){return u(this,null,function*(){yield(yield h.create({header:"Settings",message:"Settings will be available in a future update.",buttons:["OK"]})).present()})}function S(){return u(this,null,function*(){yield(yield h.create({header:"Help & Support",message:"For support, please contact your administrator.",buttons:["OK"]})).present()})}function O(){return u(this,null,function*(){yield(yield h.create({header:"About Smart Pro",message:"Smart Pro is a project management application built on Frappe Framework.",buttons:["OK"]})).present()})}function P(){return u(this,null,function*(){yield(yield h.create({header:"Logout",message:"Are you sure you want to logout?",buttons:[{text:"Cancel",role:"cancel"},{text:"Logout",role:"destructive",handler:()=>u(this,null,function*(){const e=yield J.create({message:"Logging out..."});yield e.present();try{yield fetch("/api/method/logout",{method:"POST",headers:{"Content-Type":"application/json"}}),localStorage.removeItem("user_id"),sessionStorage.clear(),window.location.href="/smart-pro/login"}catch(i){console.error("Logout error:",i),window.location.href="/smart-pro/login"}finally{yield e.dismiss()}})}]})).present()})}return T(()=>{n()}),(r,e)=>(F(),B(t(G),null,{default:o(()=>[a(t(H),null,{default:o(()=>[a(t(N),null,{default:o(()=>[a(t(K),{slot:"start"},{default:o(()=>[a(t(U),{"default-href":"/smart-pro/home",text:""})]),_:1}),a(t(V),null,{default:o(()=>[...e[0]||(e[0]=[_("Profile",-1)])]),_:1})]),_:1})]),_:1}),a(t(D),{fullscreen:!0},{default:o(()=>[s("div",Q,[s("div",W,[s("div",X,[s("span",Y,m(x.value),1)]),s("h2",Z,m(d.value),1),s("p",tt,m(l.value),1)]),s("div",et,[s("div",at,[s("div",ot,m(p.value.projects),1),e[1]||(e[1]=s("div",{class:"text-xs text-gray-500"}," Projects ",-1))]),s("div",st,[s("div",lt,m(p.value.tasks),1),e[2]||(e[2]=s("div",{class:"text-xs text-gray-500"}," Tasks ",-1))]),s("div",rt,[s("div",nt,m(p.value.completed),1),e[3]||(e[3]=s("div",{class:"text-xs text-gray-500"}," Done ",-1))])]),s("div",it,[a(t(E),{lines:"full"},{default:o(()=>[a(t(b),{button:"",onClick:g},{start:o(()=>[a(t(c),{icon:t(M)},null,8,["icon"])]),end:o(()=>[a(t(c),{icon:t(j)},null,8,["icon"])]),default:o(()=>[a(t(w),null,{default:o(()=>[...e[4]||(e[4]=[_("Settings",-1)])]),_:1})]),_:1}),a(t(b),{button:"",onClick:S},{start:o(()=>[a(t(c),{icon:t(q)},null,8,["icon"])]),end:o(()=>[a(t(c),{icon:t(j)},null,8,["icon"])]),default:o(()=>[a(t(w),null,{default:o(()=>[...e[5]||(e[5]=[_("Help & Support",-1)])]),_:1})]),_:1}),a(t(b),{button:"",onClick:O},{start:o(()=>[a(t(c),{icon:t(z)},null,8,["icon"])]),end:o(()=>[a(t(c),{icon:t(j)},null,8,["icon"])]),default:o(()=>[a(t(w),null,{default:o(()=>[...e[6]||(e[6]=[_("About",-1)])]),_:1})]),_:1}),a(t(b),{button:"",class:"text-red-500",onClick:P},{default:o(()=>[a(t(c),{slot:"start",icon:t($),color:"danger"},null,8,["icon"]),a(t(w),{color:"danger"},{default:o(()=>[...e[7]||(e[7]=[_(" Logout ",-1)])]),_:1})]),_:1})]),_:1})]),e[8]||(e[8]=s("div",{class:"text-center mt-6 text-sm text-gray-400"}," Smart Pro v1.0.0 ",-1))])]),_:1})]),_:1}))}};export{pt as default};
//# sourceMappingURL=Profile-D3EXbmAA.js.map
