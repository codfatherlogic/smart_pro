{"version":3,"file":"Profile-nPQpl32c.js","sources":["../../../frontend/src/views/Profile.vue"],"sourcesContent":["<template>\n  <ion-page>\n    <ion-header>\n      <ion-toolbar>\n        <ion-buttons slot=\"start\">\n          <ion-back-button default-href=\"/smart-pro/home\" text=\"\" />\n        </ion-buttons>\n        <ion-title>Profile</ion-title>\n      </ion-toolbar>\n    </ion-header>\n\n    <ion-content :fullscreen=\"true\">\n      <div class=\"p-4\">\n        <!-- User Info Card -->\n        <div class=\"app-card p-6 mb-6 text-center\">\n          <div\n            class=\"w-20 h-20 rounded-full bg-primary-100 flex items-center justify-center mx-auto mb-4\"\n          >\n            <span class=\"text-3xl font-bold text-primary-600\">\n              {{ userInitials }}\n            </span>\n          </div>\n          <h2 class=\"text-xl font-semibold text-gray-800\">\n            {{ userName }}\n          </h2>\n          <p class=\"text-gray-500\">\n            {{ userEmail }}\n          </p>\n        </div>\n\n        <!-- Stats -->\n        <div class=\"grid grid-cols-3 gap-4 mb-6\">\n          <div class=\"app-card p-4 text-center\">\n            <div class=\"text-2xl font-bold text-primary-500\">\n              {{ stats.projects }}\n            </div>\n            <div class=\"text-xs text-gray-500\">\n              Projects\n            </div>\n          </div>\n          <div class=\"app-card p-4 text-center\">\n            <div class=\"text-2xl font-bold text-orange-500\">\n              {{ stats.tasks }}\n            </div>\n            <div class=\"text-xs text-gray-500\">\n              Tasks\n            </div>\n          </div>\n          <div class=\"app-card p-4 text-center\">\n            <div class=\"text-2xl font-bold text-green-500\">\n              {{ stats.completed }}\n            </div>\n            <div class=\"text-xs text-gray-500\">\n              Done\n            </div>\n          </div>\n        </div>\n\n        <!-- Menu Items -->\n        <div class=\"app-card\">\n          <ion-list lines=\"full\">\n            <ion-item\n              button\n              @click=\"openSettings\"\n            >\n              <template #start>\n                <ion-icon :icon=\"settingsOutline\" />\n              </template>\n              <ion-label>Settings</ion-label>\n              <template #end>\n                <ion-icon :icon=\"chevronForwardOutline\" />\n              </template>\n            </ion-item>\n\n            <ion-item\n              button\n              @click=\"openHelp\"\n            >\n              <template #start>\n                <ion-icon :icon=\"helpCircleOutline\" />\n              </template>\n              <ion-label>Help & Support</ion-label>\n              <template #end>\n                <ion-icon :icon=\"chevronForwardOutline\" />\n              </template>\n            </ion-item>\n\n            <ion-item\n              button\n              @click=\"openAbout\"\n            >\n              <template #start>\n                <ion-icon :icon=\"informationCircleOutline\" />\n              </template>\n              <ion-label>About</ion-label>\n              <template #end>\n                <ion-icon :icon=\"chevronForwardOutline\" />\n              </template>\n            </ion-item>\n\n            <ion-item\n              button\n              class=\"text-red-500\"\n              @click=\"logout\"\n            >\n              <ion-icon\n                slot=\"start\"\n                :icon=\"logOutOutline\"\n                color=\"danger\"\n              />\n              <ion-label color=\"danger\">\n                Logout\n              </ion-label>\n            </ion-item>\n          </ion-list>\n        </div>\n\n        <!-- App Version -->\n        <div class=\"text-center mt-6 text-sm text-gray-400\">\n          Smart Pro v1.0.0\n        </div>\n      </div>\n    </ion-content>\n  </ion-page>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from \"vue\"\nimport { useRouter } from \"vue-router\"\nimport {\n  IonPage,\n  IonHeader,\n  IonToolbar,\n  IonTitle,\n  IonContent,\n  IonList,\n  IonItem,\n  IonLabel,\n  IonIcon,\n  IonButtons,\n  IonBackButton,\n  alertController,\n  loadingController,\n} from \"@ionic/vue\"\nimport {\n  settingsOutline,\n  helpCircleOutline,\n  informationCircleOutline,\n  logOutOutline,\n  chevronForwardOutline,\n} from \"ionicons/icons\"\nimport { createResource, call } from \"frappe-ui\"\n\nconst router = useRouter()\n\nconst userName = ref(\"\")\nconst userEmail = ref(\"\")\nconst stats = ref({ projects: 0, tasks: 0, completed: 0 })\n\nconst userInitials = computed(() => {\n  if (!userName.value) return \"?\"\n  return userName.value\n    .split(\" \")\n    .map((n) => n[0])\n    .join(\"\")\n    .toUpperCase()\n    .slice(0, 2)\n})\n\nconst userResource = createResource({\n  url: \"frappe.auth.get_logged_user\",\n  auto: false,\n})\n\nconst projectsResource = createResource({\n  url: \"smart_pro.smart_pro.api.projects.get_user_projects\",\n  auto: false,\n})\n\nconst tasksResource = createResource({\n  url: \"smart_pro.smart_pro.api.projects.get_user_tasks\",\n  auto: false,\n})\n\nasync function loadUserData() {\n  try {\n    await userResource.fetch()\n    userEmail.value = userResource.data || \"\"\n\n    // Get full name\n    if (userEmail.value) {\n      const userDoc = await call(\"frappe.client.get_value\", {\n        doctype: \"User\",\n        filters: { name: userEmail.value },\n        fieldname: \"full_name\",\n      })\n      userName.value = userDoc?.full_name || userEmail.value\n    }\n\n    // Load stats\n    await Promise.all([projectsResource.fetch(), tasksResource.fetch()])\n\n    const projects = projectsResource.data || []\n    const tasks = tasksResource.data || []\n\n    stats.value = {\n      projects: projects.length,\n      tasks: tasks.length,\n      completed: tasks.filter((t) => t.status === \"Completed\").length,\n    }\n  } catch (error) {\n    console.error(\"Error loading user data:\", error)\n  }\n}\n\nasync function openSettings() {\n  const alert = await alertController.create({\n    header: \"Settings\",\n    message: \"Settings will be available in a future update.\",\n    buttons: [\"OK\"],\n  })\n  await alert.present()\n}\n\nasync function openHelp() {\n  const alert = await alertController.create({\n    header: \"Help & Support\",\n    message: \"For support, please contact your administrator.\",\n    buttons: [\"OK\"],\n  })\n  await alert.present()\n}\n\nasync function openAbout() {\n  const alert = await alertController.create({\n    header: \"About Smart Pro\",\n    message: \"Smart Pro is a project management application built on Frappe Framework.\",\n    buttons: [\"OK\"],\n  })\n  await alert.present()\n}\n\nasync function logout() {\n  const alert = await alertController.create({\n    header: \"Logout\",\n    message: \"Are you sure you want to logout?\",\n    buttons: [\n      {\n        text: \"Cancel\",\n        role: \"cancel\",\n      },\n      {\n        text: \"Logout\",\n        role: \"destructive\",\n        handler: async () => {\n          const loading = await loadingController.create({\n            message: \"Logging out...\",\n          })\n          await loading.present()\n\n          try {\n            // Call Frappe logout API\n            await fetch(\"/api/method/logout\", {\n              method: \"POST\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n              },\n            })\n            // Clear any local storage\n            localStorage.removeItem(\"user_id\")\n            sessionStorage.clear()\n            // Redirect to login page\n            window.location.href = \"/smart-pro/login\"\n          } catch (error) {\n            console.error(\"Logout error:\", error)\n            // Force redirect even if logout fails\n            window.location.href = \"/smart-pro/login\"\n          } finally {\n            await loading.dismiss()\n          }\n        },\n      },\n    ],\n  })\n  await alert.present()\n}\n\nonMounted(() => {\n  loadUserData()\n})\n</script>\n"],"names":["useRouter","userName","ref","userEmail","stats","userInitials","computed","n","userResource","createResource","projectsResource","tasksResource","loadUserData","__async","userDoc","call","projects","tasks","t","error","openSettings","alertController","openHelp","openAbout","logout","loading","loadingController","onMounted","_createBlock","_unref","IonPage","_createVNode","IonHeader","IonToolbar","IonButtons","IonBackButton","IonTitle","_cache","IonContent","_createElementVNode","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_toDisplayString","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","IonList","IonItem","IonIcon","settingsOutline","chevronForwardOutline","IonLabel","helpCircleOutline","informationCircleOutline","logOutOutline"],"mappings":"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"}