var B=(I,h,_)=>new Promise((x,v)=>{var m=i=>{try{p(_.next(i))}catch(f){v(f)}},o=i=>{try{p(_.throw(i))}catch(f){v(f)}},p=i=>i.done?x(i.value):Promise.resolve(i.value).then(m,o);p((_=_.apply(I,h)).next())});import{r as g,L as b,a as Y,A as $,q as d,t as c,u as L,M as O,i as A,l as n,n as u,v as D,k as r,N as y,x as t,y as a,P as N,F as T,O as M}from"./frappe-ui-5f3Xtay5.js";import{j as S,k as U,m as q,y as z,l as W,r as G,n as J,w as K,x as Q,i as X}from"./index-By_Ni_xe.js";const Z={key:0,class:"p-4"},tt={key:1,class:"empty-state h-full"},et={class:"empty-state-description"},st={key:2,class:"p-4"},at={class:"mb-6"},ot={class:"flex justify-between items-start mb-2"},nt={class:"text-2xl font-bold text-gray-800"},lt={key:0,class:"text-gray-600"},rt={class:"grid grid-cols-2 gap-4 mb-6"},it={class:"app-card p-4"},ct={class:"font-medium"},dt={class:"app-card p-4"},ut={class:"font-medium"},pt={key:0,class:"app-card p-4"},mt={class:"font-medium"},_t={key:1,class:"app-card p-4"},vt={class:"font-medium"},ft={class:"app-card mb-6"},gt={class:"app-card-header flex justify-between items-center"},yt={key:0,class:"p-4 text-center text-gray-500"},ht={key:1},xt=["onClick"],jt={class:"flex-1"},kt={class:"font-medium text-gray-800"},bt={class:"text-sm text-gray-500"},It={key:0,class:"app-card"},Ct={class:"app-card-header"},Rt={class:"flex items-center"},wt={class:"w-10 h-10 rounded-full bg-primary-100 flex items-center justify-center mr-3"},Bt={class:"text-sm font-medium text-primary-600"},Dt={class:"font-medium text-gray-800"},Nt={class:"text-sm text-gray-500"},Tt={class:"text-sm text-gray-500"},Ht={__name:"ProjectDetail",setup(I){const h=L(),_=O(),x=A("$dayjs"),v=g(!0),m=g(""),o=g(null),p=g([]),i=g([]),f=b({url:"smart_pro.smart_pro.api.projects.get_project_details",auto:!1}),C=b({url:"smart_pro.smart_pro.api.projects.get_project_tasks",auto:!1}),R=b({url:"smart_pro.smart_pro.api.projects.get_employee_assignments",auto:!1});function j(){return B(this,null,function*(){const s=h.params.id;if(!s){m.value="Project not found";return}v.value=!0,m.value="";try{yield Promise.all([f.fetch({project_name:s}),C.fetch({project_name:s}),R.fetch({project_name:s})]),o.value=f.data,p.value=C.data||[],i.value=R.data||[]}catch(e){console.error("Error loading project:",e),m.value=e.message||"Failed to load project"}finally{v.value=!1}})}function P(s){j().finally(()=>{s.target.complete()})}function k(s){return s?x(s).format("MMM D, YYYY"):"-"}function E(s){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(s)}function w(s){return{Active:"active",Planning:"planning",Completed:"completed","On Hold":"on-hold",Cancelled:"cancelled",Open:"planning",Working:"on-hold"}[s]||""}function F(s){if(!s)return"";const e=document.createElement("div");return e.innerHTML=s,e.textContent||e.innerText||""}function H(s){return s?s.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"?"}function V(s){_.push(`/smart-pro/task/${encodeURIComponent(s)}`)}return Y(()=>{j()}),(s,e)=>(n(),$(c(X),null,{default:d(()=>[u(c(S),null,{default:d(()=>[u(c(U),null,{default:d(()=>[u(c(q),{slot:"start"},{default:d(()=>[u(c(z),{"default-href":"/smart-pro/projects",text:""})]),_:1}),u(c(W),null,{default:d(()=>[...e[0]||(e[0]=[D("Project Details",-1)])]),_:1})]),_:1})]),_:1}),u(c(G),{fullscreen:!0},{fixed:d(()=>[u(c(K),{onIonRefresh:P},{default:d(()=>[u(c(Q))]),_:1})]),default:d(()=>[v.value?(n(),r("div",Z,[...e[1]||(e[1]=[t("div",{class:"skeleton h-8 w-3/4 mb-4"},null,-1),t("div",{class:"skeleton h-4 w-1/2 mb-6"},null,-1),t("div",{class:"skeleton h-24 w-full mb-4"},null,-1),t("div",{class:"skeleton h-32 w-full"},null,-1)])])):m.value?(n(),r("div",tt,[e[3]||(e[3]=t("div",{class:"empty-state-title"}," Error loading project ",-1)),t("div",et,a(m.value),1),u(c(J),{class:"mt-4",onClick:j},{default:d(()=>[...e[2]||(e[2]=[D(" Retry ",-1)])]),_:1})])):o.value?(n(),r("div",st,[t("div",at,[t("div",ot,[t("h1",nt,a(o.value.title),1),t("span",{class:N(["status-badge",w(o.value.status)])},a(o.value.status),3)]),o.value.description?(n(),r("p",lt,a(F(o.value.description)),1)):y("",!0)]),t("div",rt,[t("div",it,[e[4]||(e[4]=t("div",{class:"text-xs text-gray-500 mb-1"}," Start Date ",-1)),t("div",ct,a(k(o.value.start_date)),1)]),t("div",dt,[e[5]||(e[5]=t("div",{class:"text-xs text-gray-500 mb-1"}," End Date ",-1)),t("div",ut,a(k(o.value.end_date)),1)]),o.value.project_manager?(n(),r("div",pt,[e[6]||(e[6]=t("div",{class:"text-xs text-gray-500 mb-1"}," Manager ",-1)),t("div",mt,a(o.value.project_manager),1)])):y("",!0),o.value.budget_amount?(n(),r("div",_t,[e[7]||(e[7]=t("div",{class:"text-xs text-gray-500 mb-1"}," Budget ",-1)),t("div",vt,a(E(o.value.budget_amount)),1)])):y("",!0)]),t("div",ft,[t("div",gt,[t("span",null,"Tasks ("+a(p.value.length)+")",1)]),p.value.length===0?(n(),r("div",yt," No tasks for this project ")):(n(),r("div",ht,[(n(!0),r(T,null,M(p.value,l=>(n(),r("div",{key:l.name,class:"app-list-item",onClick:Mt=>V(l.name)},[t("div",jt,[t("div",kt,a(l.title||l.name),1),t("div",bt," Due: "+a(k(l.due_date)),1)]),t("span",{class:N(["status-badge",w(l.status)])},a(l.status),3)],8,xt))),128))]))]),i.value.length>0?(n(),r("div",It,[t("div",Ct,[t("span",null,"Team ("+a(i.value.length)+")",1)]),t("div",null,[(n(!0),r(T,null,M(i.value,l=>(n(),r("div",{key:l.name,class:"app-list-item"},[t("div",Rt,[t("div",wt,[t("span",Bt,a(H(l.employee_name)),1)]),t("div",null,[t("div",Dt,a(l.employee_name),1),t("div",Nt,a(l.role),1)])]),t("div",Tt,a(l.allocation_percentage)+"% ",1)]))),128))])])):y("",!0)])):y("",!0)]),_:1})]),_:1}))}};export{Ht as default};
//# sourceMappingURL=ProjectDetail-Cc6P9Pic.js.map
