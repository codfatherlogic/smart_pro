{"version":3,"file":"ProjectDetail-Dt_i3wDE.js","sources":["../../../frontend/src/views/ProjectDetail.vue"],"sourcesContent":["<template>\n  <ion-page>\n    <ion-header>\n      <ion-toolbar>\n        <ion-buttons slot=\"start\">\n          <ion-back-button\n            default-href=\"/smart-pro/projects\"\n            text=\"\"\n          />\n        </ion-buttons>\n        <ion-title>Project Details</ion-title>\n      </ion-toolbar>\n    </ion-header>\n\n    <ion-content :fullscreen=\"true\">\n      <template #fixed>\n        <ion-refresher @ion-refresh=\"handleRefresh\">\n          <ion-refresher-content />\n        </ion-refresher>\n      </template>\n\n      <!-- Loading State -->\n      <div\n        v-if=\"loading\"\n        class=\"p-4\"\n      >\n        <div class=\"skeleton h-8 w-3/4 mb-4\" />\n        <div class=\"skeleton h-4 w-1/2 mb-6\" />\n        <div class=\"skeleton h-24 w-full mb-4\" />\n        <div class=\"skeleton h-32 w-full\" />\n      </div>\n\n      <!-- Error State -->\n      <div\n        v-else-if=\"error\"\n        class=\"empty-state h-full\"\n      >\n        <div class=\"empty-state-title\">\n          Error loading project\n        </div>\n        <div class=\"empty-state-description\">\n          {{ error }}\n        </div>\n        <ion-button\n          class=\"mt-4\"\n          @click=\"loadData\"\n        >\n          Retry\n        </ion-button>\n      </div>\n\n      <!-- Project Details -->\n      <div\n        v-else-if=\"project\"\n        class=\"p-4\"\n      >\n        <!-- Header -->\n        <div class=\"mb-6\">\n          <div class=\"flex justify-between items-start mb-2\">\n            <h1 class=\"text-2xl font-bold text-gray-800\">\n              {{ project.title }}\n            </h1>\n            <span :class=\"['status-badge', getStatusClass(project.status)]\">\n              {{ project.status }}\n            </span>\n          </div>\n          <p\n            v-if=\"project.description\"\n            class=\"text-gray-600\"\n          >\n            {{ stripHtml(project.description) }}\n          </p>\n        </div>\n\n        <!-- Info Cards -->\n        <div class=\"grid grid-cols-2 gap-4 mb-6\">\n          <div class=\"app-card p-4\">\n            <div class=\"text-xs text-gray-500 mb-1\">\n              Start Date\n            </div>\n            <div class=\"font-medium\">\n              {{ formatDate(project.start_date) }}\n            </div>\n          </div>\n          <div class=\"app-card p-4\">\n            <div class=\"text-xs text-gray-500 mb-1\">\n              End Date\n            </div>\n            <div class=\"font-medium\">\n              {{ formatDate(project.end_date) }}\n            </div>\n          </div>\n          <div\n            v-if=\"project.project_manager\"\n            class=\"app-card p-4\"\n          >\n            <div class=\"text-xs text-gray-500 mb-1\">\n              Manager\n            </div>\n            <div class=\"font-medium\">\n              {{ project.project_manager }}\n            </div>\n          </div>\n          <div\n            v-if=\"project.budget_amount\"\n            class=\"app-card p-4\"\n          >\n            <div class=\"text-xs text-gray-500 mb-1\">\n              Budget\n            </div>\n            <div class=\"font-medium\">\n              {{ formatCurrency(project.budget_amount) }}\n            </div>\n          </div>\n        </div>\n\n        <!-- Tasks Section -->\n        <div class=\"app-card mb-6\">\n          <div class=\"app-card-header flex justify-between items-center\">\n            <span>Tasks ({{ tasks.length }})</span>\n          </div>\n          <div\n            v-if=\"tasks.length === 0\"\n            class=\"p-4 text-center text-gray-500\"\n          >\n            No tasks for this project\n          </div>\n          <div v-else>\n            <div\n              v-for=\"task in tasks\"\n              :key=\"task.name\"\n              class=\"app-list-item\"\n              @click=\"goToTask(task.name)\"\n            >\n              <div class=\"flex-1\">\n                <div class=\"font-medium text-gray-800\">\n                  {{ task.title || task.name }}\n                </div>\n                <div class=\"text-sm text-gray-500\">\n                  Due: {{ formatDate(task.due_date) }}\n                </div>\n              </div>\n              <span :class=\"['status-badge', getStatusClass(task.status)]\">\n                {{ task.status }}\n              </span>\n            </div>\n          </div>\n        </div>\n\n        <!-- Team Section -->\n        <div\n          v-if=\"assignments.length > 0\"\n          class=\"app-card\"\n        >\n          <div class=\"app-card-header\">\n            <span>Team ({{ assignments.length }})</span>\n          </div>\n          <div>\n            <div\n              v-for=\"member in assignments\"\n              :key=\"member.name\"\n              class=\"app-list-item\"\n            >\n              <div class=\"flex items-center\">\n                <div\n                  class=\"w-10 h-10 rounded-full bg-primary-100 flex items-center justify-center mr-3\"\n                >\n                  <span class=\"text-sm font-medium text-primary-600\">\n                    {{ getInitials(member.employee_name) }}\n                  </span>\n                </div>\n                <div>\n                  <div class=\"font-medium text-gray-800\">\n                    {{ member.employee_name }}\n                  </div>\n                  <div class=\"text-sm text-gray-500\">\n                    {{ member.role }}\n                  </div>\n                </div>\n              </div>\n              <div class=\"text-sm text-gray-500\">\n                {{ member.allocation_percentage }}%\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </ion-content>\n  </ion-page>\n</template>\n\n<script setup>\nimport { ref, onMounted, inject } from \"vue\"\nimport { useRoute, useRouter } from \"vue-router\"\nimport {\n  IonPage,\n  IonHeader,\n  IonToolbar,\n  IonTitle,\n  IonContent,\n  IonButtons,\n  IonBackButton,\n  IonButton,\n  IonRefresher,\n  IonRefresherContent,\n} from \"@ionic/vue\"\nimport { createResource } from \"frappe-ui\"\n\nconst route = useRoute()\nconst router = useRouter()\nconst $dayjs = inject(\"$dayjs\")\n\nconst loading = ref(true)\nconst error = ref(\"\")\nconst project = ref(null)\nconst tasks = ref([])\nconst assignments = ref([])\n\nconst projectResource = createResource({\n  url: \"smart_pro.smart_pro.api.projects.get_project_details\",\n  auto: false,\n})\n\nconst tasksResource = createResource({\n  url: \"smart_pro.smart_pro.api.projects.get_project_tasks\",\n  auto: false,\n})\n\nconst assignmentsResource = createResource({\n  url: \"smart_pro.smart_pro.api.projects.get_employee_assignments\",\n  auto: false,\n})\n\nasync function loadData() {\n  const projectId = route.params.id\n  if (!projectId) {\n    error.value = \"Project not found\"\n    return\n  }\n\n  loading.value = true\n  error.value = \"\"\n\n  try {\n    await Promise.all([\n      projectResource.fetch({ project_name: projectId }),\n      tasksResource.fetch({ project_name: projectId }),\n      assignmentsResource.fetch({ project_name: projectId }),\n    ])\n\n    project.value = projectResource.data\n    tasks.value = tasksResource.data || []\n    assignments.value = assignmentsResource.data || []\n  } catch (err) {\n    console.error(\"Error loading project:\", err)\n    error.value = err.message || \"Failed to load project\"\n  } finally {\n    loading.value = false\n  }\n}\n\nfunction handleRefresh(event) {\n  loadData().finally(() => {\n    event.target.complete()\n  })\n}\n\nfunction formatDate(dateStr) {\n  if (!dateStr) return \"-\"\n  return $dayjs(dateStr).format(\"MMM D, YYYY\")\n}\n\nfunction formatCurrency(amount) {\n  return new Intl.NumberFormat(\"en-IN\", {\n    style: \"currency\",\n    currency: \"INR\",\n  }).format(amount)\n}\n\nfunction getStatusClass(status) {\n  const map = {\n    Active: \"active\",\n    Planning: \"planning\",\n    Completed: \"completed\",\n    \"On Hold\": \"on-hold\",\n    Cancelled: \"cancelled\",\n    Open: \"planning\",\n    Working: \"on-hold\",\n  }\n  return map[status] || \"\"\n}\n\nfunction stripHtml(html) {\n  if (!html) return \"\"\n  // Create a temporary element to parse HTML and extract text\n  const tmp = document.createElement(\"div\")\n  tmp.innerHTML = html\n  return tmp.textContent || tmp.innerText || \"\"\n}\n\nfunction getInitials(name) {\n  if (!name) return \"?\"\n  return name\n    .split(\" \")\n    .map((n) => n[0])\n    .join(\"\")\n    .toUpperCase()\n    .slice(0, 2)\n}\n\nfunction goToTask(id) {\n  router.push(`/smart-pro/task/${encodeURIComponent(id)}`)\n}\n\nonMounted(() => {\n  loadData()\n})\n</script>\n"],"names":["route","useRoute","router","useRouter","$dayjs","inject","loading","ref","error","project","tasks","assignments","projectResource","createResource","tasksResource","assignmentsResource","loadData","__async","projectId","err","handleRefresh","event","formatDate","dateStr","formatCurrency","amount","getStatusClass","status","stripHtml","html","tmp","getInitials","name","n","goToTask","id","onMounted","_createBlock","_unref","IonPage","_createVNode","IonHeader","IonToolbar","IonButtons","IonBackButton","IonTitle","_cache","IonContent","IonRefresher","IonRefresherContent","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_toDisplayString","IonButton","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_normalizeClass","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_Fragment","_renderList","task","$event","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","member","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33"],"mappings":"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"}