var g=(n,o,r)=>new Promise((t,c)=>{var u=a=>{try{e(r.next(a))}catch(_){c(_)}},i=a=>{try{e(r.throw(a))}catch(_){c(_)}},e=a=>a.done?t(a.value):Promise.resolve(a.value).then(u,i);e((r=r.apply(n,o)).next())});import{c as f,r as l,z as j}from"./frappe-ui-5f3Xtay5.js";const s=l({has_full_access:!1,is_project_manager:!1,managed_projects:[]}),m=l(!1),p=l(null),v=l(!1);function P(){function n(){return g(this,null,function*(){if(v.value)return s.value;m.value=!0,p.value=null;try{const e=yield j("smart_pro.smart_pro.api.projects.get_user_permissions");return e!=null&&e.success&&(s.value={has_full_access:e.has_full_access||!1,is_project_manager:e.is_project_manager||!1,managed_projects:e.managed_projects||[]}),v.value=!0,console.log("User permissions fetched:",s.value),s.value}catch(e){return p.value=e,console.error("Failed to fetch user permissions:",e),s.value}finally{m.value=!1}})}const o=f(()=>s.value.has_full_access),r=f(()=>s.value.is_project_manager),t=f(()=>s.value.managed_projects);function c(e){return s.value.has_full_access?!0:s.value.is_project_manager?s.value.managed_projects.includes(e):!1}function u(e){return s.value.has_full_access}function i(){s.value={has_full_access:!1,is_project_manager:!1,managed_projects:[]},v.value=!1}return{permissions:s,loading:m,error:p,fetchPermissions:n,hasFullAccess:o,isProjectManager:r,managedProjects:t,canApproveTimesheetForProject:c,isReadOnlyForItem:u,clearPermissions:i}}export{P as u};
//# sourceMappingURL=usePermissions-DkJGg_er.js.map
