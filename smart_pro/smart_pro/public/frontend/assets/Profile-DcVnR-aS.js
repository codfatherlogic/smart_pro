var d=(I,w,n)=>new Promise((i,u)=>{var h=l=>{try{f(n.next(l))}catch(m){u(m)}},x=l=>{try{f(n.throw(l))}catch(m){u(m)}},f=l=>l.done?i(l.value):Promise.resolve(l.value).then(h,x);f((n=n.apply(I,w)).next())});import{a as k,c as H,E as j,F as R,e as A,j as o,l as t,P as S,G as N,f as T,k as a,D as _,H as s,I as g}from"./frappe-ui-BxXHPJLj.js";import{g as B,h as D,i as E,j as K,u as U,v,d as p,e as b,f as V,r as y,w as G}from"./index-CDDuZJGk.js";import{s as M,b as C,d as q,i as z,l as J}from"./index-DEyDSjtY.js";const Q={class:"p-4"},W={class:"app-card p-6 mb-6 text-center"},X={class:"w-20 h-20 rounded-full bg-primary-100 flex items-center justify-center mx-auto mb-4"},Y={class:"text-3xl font-bold text-primary-600"},Z={class:"text-xl font-semibold text-gray-800"},$={class:"text-gray-500"},tt={class:"grid grid-cols-3 gap-4 mb-6"},et={class:"app-card p-4 text-center"},at={class:"text-2xl font-bold text-primary-500"},st={class:"app-card p-4 text-center"},ot={class:"text-2xl font-bold text-orange-500"},lt={class:"app-card p-4 text-center"},rt={class:"text-2xl font-bold text-green-500"},nt={class:"app-card"},pt={__name:"Profile",setup(I){const w=N(),n=k(""),i=k(""),u=k({projects:0,tasks:0,completed:0}),h=H(()=>n.value?n.value.split(" ").map(r=>r[0]).join("").toUpperCase().slice(0,2):"?"),x=j({url:"frappe.auth.get_logged_user",auto:!1}),f=j({url:"smart_pro.smart_pro.api.projects.get_user_projects",auto:!1}),l=j({url:"smart_pro.smart_pro.api.projects.get_user_tasks",auto:!1});function m(){return d(this,null,function*(){try{if(yield x.fetch(),i.value=x.data||"",i.value){const c=yield S("frappe.client.get_value",{doctype:"User",filters:{name:i.value},fieldname:"full_name"});n.value=(c==null?void 0:c.full_name)||i.value}yield Promise.all([f.fetch(),l.fetch()]);const r=f.data||[],e=l.data||[];u.value={projects:r.length,tasks:e.length,completed:e.filter(c=>c.status==="Completed").length}}catch(r){console.error("Error loading user data:",r)}})}function O(){return d(this,null,function*(){yield(yield y.create({header:"Settings",message:"Settings will be available in a future update.",buttons:["OK"]})).present()})}function P(){return d(this,null,function*(){yield(yield y.create({header:"Help & Support",message:"For support, please contact your administrator.",buttons:["OK"]})).present()})}function L(){return d(this,null,function*(){yield(yield y.create({header:"About Smart Pro",message:"Smart Pro is a project management application built on Frappe Framework.",buttons:["OK"]})).present()})}function F(){return d(this,null,function*(){yield(yield y.create({header:"Logout",message:"Are you sure you want to logout?",buttons:[{text:"Cancel",role:"cancel"},{text:"Logout",role:"destructive",handler:()=>d(this,null,function*(){const e=yield G.create({message:"Logging out..."});yield e.present();try{yield S("logout"),w.push("/smart-pro/login")}catch(c){console.error("Logout error:",c)}finally{yield e.dismiss()}})}]})).present()})}return R(()=>{m()}),(r,e)=>(T(),A(t(V),null,{default:o(()=>[a(t(B),null,{default:o(()=>[a(t(D),null,{default:o(()=>[a(t(E),null,{default:o(()=>[...e[0]||(e[0]=[_("Profile",-1)])]),_:1})]),_:1})]),_:1}),a(t(K),{fullscreen:!0},{default:o(()=>[s("div",Q,[s("div",W,[s("div",X,[s("span",Y,g(h.value),1)]),s("h2",Z,g(n.value),1),s("p",$,g(i.value),1)]),s("div",tt,[s("div",et,[s("div",at,g(u.value.projects),1),e[1]||(e[1]=s("div",{class:"text-xs text-gray-500"},"Projects",-1))]),s("div",st,[s("div",ot,g(u.value.tasks),1),e[2]||(e[2]=s("div",{class:"text-xs text-gray-500"},"Tasks",-1))]),s("div",lt,[s("div",rt,g(u.value.completed),1),e[3]||(e[3]=s("div",{class:"text-xs text-gray-500"},"Done",-1))])]),s("div",nt,[a(t(U),{lines:"full"},{default:o(()=>[a(t(v),{button:"",onClick:O},{default:o(()=>[a(t(p),{icon:t(M),slot:"start"},null,8,["icon"]),a(t(b),null,{default:o(()=>[...e[4]||(e[4]=[_("Settings",-1)])]),_:1}),a(t(p),{icon:t(C),slot:"end"},null,8,["icon"])]),_:1}),a(t(v),{button:"",onClick:P},{default:o(()=>[a(t(p),{icon:t(q),slot:"start"},null,8,["icon"]),a(t(b),null,{default:o(()=>[...e[5]||(e[5]=[_("Help & Support",-1)])]),_:1}),a(t(p),{icon:t(C),slot:"end"},null,8,["icon"])]),_:1}),a(t(v),{button:"",onClick:L},{default:o(()=>[a(t(p),{icon:t(z),slot:"start"},null,8,["icon"]),a(t(b),null,{default:o(()=>[...e[6]||(e[6]=[_("About",-1)])]),_:1}),a(t(p),{icon:t(C),slot:"end"},null,8,["icon"])]),_:1}),a(t(v),{button:"",onClick:F,class:"text-red-500"},{default:o(()=>[a(t(p),{icon:t(J),slot:"start",color:"danger"},null,8,["icon"]),a(t(b),{color:"danger"},{default:o(()=>[...e[7]||(e[7]=[_("Logout",-1)])]),_:1})]),_:1})]),_:1})]),e[8]||(e[8]=s("div",{class:"text-center mt-6 text-sm text-gray-400"}," Smart Pro v1.0.0 ",-1))])]),_:1})]),_:1}))}};export{pt as default};
//# sourceMappingURL=Profile-DcVnR-aS.js.map
