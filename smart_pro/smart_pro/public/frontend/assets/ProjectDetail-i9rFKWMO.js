var D=(b,y,m)=>new Promise((x,v)=>{var _=i=>{try{u(m.next(i))}catch(f){v(f)}},o=i=>{try{u(m.throw(i))}catch(f){v(f)}},u=i=>i.done?x(i.value):Promise.resolve(i.value).then(_,o);u((m=m.apply(b,y)).next())});import{a as g,E as I,F as Y,e as $,j as p,l as c,u as H,G as O,i as L,f as n,k as d,D as B,J as r,O as h,H as t,I as a,M as N,K as T,L as M}from"./frappe-ui-BxXHPJLj.js";import{g as S,h as U,n as z,x as A,i as G,j as J,k as K,l as W,m as q,f as Q}from"./index-CDDuZJGk.js";const X={key:0,class:"p-4"},Z={key:1,class:"empty-state h-full"},tt={class:"empty-state-description"},et={key:2,class:"p-4"},st={class:"mb-6"},at={class:"flex justify-between items-start mb-2"},ot={class:"text-2xl font-bold text-gray-800"},nt={key:0,class:"text-gray-600"},lt={class:"grid grid-cols-2 gap-4 mb-6"},rt={class:"app-card p-4"},it={class:"font-medium"},ct={class:"app-card p-4"},dt={class:"font-medium"},ut={key:0,class:"app-card p-4"},pt={class:"font-medium"},_t={key:1,class:"app-card p-4"},mt={class:"font-medium"},vt={class:"app-card mb-6"},ft={class:"app-card-header flex justify-between items-center"},gt={key:0,class:"p-4 text-center text-gray-500"},ht={key:1},yt=["onClick"],xt={class:"flex-1"},jt={class:"font-medium text-gray-800"},kt={class:"text-sm text-gray-500"},It={key:0,class:"app-card"},bt={class:"app-card-header"},Ct={class:"flex items-center"},Rt={class:"w-10 h-10 rounded-full bg-primary-100 flex items-center justify-center mr-3"},wt={class:"text-sm font-medium text-primary-600"},Dt={class:"font-medium text-gray-800"},Bt={class:"text-sm text-gray-500"},Nt={class:"text-sm text-gray-500"},Ft={__name:"ProjectDetail",setup(b){const y=H(),m=O(),x=L("$dayjs"),v=g(!0),_=g(""),o=g(null),u=g([]),i=g([]),f=I({url:"smart_pro.smart_pro.api.projects.get_project_details",auto:!1}),C=I({url:"smart_pro.smart_pro.api.projects.get_project_tasks",auto:!1}),R=I({url:"smart_pro.smart_pro.api.projects.get_employee_assignments",auto:!1});function j(){return D(this,null,function*(){const s=y.params.id;if(!s){_.value="Project not found";return}v.value=!0,_.value="";try{yield Promise.all([f.fetch({project_name:s}),C.fetch({project_name:s}),R.fetch({project_name:s})]),o.value=f.data,u.value=C.data||[],i.value=R.data||[]}catch(e){console.error("Error loading project:",e),_.value=e.message||"Failed to load project"}finally{v.value=!1}})}function P(s){j().finally(()=>{s.target.complete()})}function k(s){return s?x(s).format("MMM D, YYYY"):"-"}function E(s){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(s)}function w(s){return{Active:"active",Planning:"planning",Completed:"completed","On Hold":"on-hold",Cancelled:"cancelled",Open:"planning",Working:"on-hold"}[s]||""}function F(s){return s?s.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"?"}function V(s){m.push(`/smart-pro/task/${encodeURIComponent(s)}`)}return Y(()=>{j()}),(s,e)=>(n(),$(c(Q),null,{default:p(()=>[d(c(S),null,{default:p(()=>[d(c(U),null,{default:p(()=>[d(c(z),{slot:"start"},{default:p(()=>[d(c(A),{"default-href":"/smart-pro/projects"})]),_:1}),d(c(G),null,{default:p(()=>[...e[0]||(e[0]=[B("Project Details",-1)])]),_:1})]),_:1})]),_:1}),d(c(J),{fullscreen:!0},{default:p(()=>[d(c(K),{slot:"fixed",onIonRefresh:P},{default:p(()=>[d(c(W))]),_:1}),v.value?(n(),r("div",X,[...e[1]||(e[1]=[t("div",{class:"skeleton h-8 w-3/4 mb-4"},null,-1),t("div",{class:"skeleton h-4 w-1/2 mb-6"},null,-1),t("div",{class:"skeleton h-24 w-full mb-4"},null,-1),t("div",{class:"skeleton h-32 w-full"},null,-1)])])):_.value?(n(),r("div",Z,[e[3]||(e[3]=t("div",{class:"empty-state-title"},"Error loading project",-1)),t("div",tt,a(_.value),1),d(c(q),{class:"mt-4",onClick:j},{default:p(()=>[...e[2]||(e[2]=[B("Retry",-1)])]),_:1})])):o.value?(n(),r("div",et,[t("div",st,[t("div",at,[t("h1",ot,a(o.value.title),1),t("span",{class:N(["status-badge",w(o.value.status)])},a(o.value.status),3)]),o.value.description?(n(),r("p",nt,a(o.value.description),1)):h("",!0)]),t("div",lt,[t("div",rt,[e[4]||(e[4]=t("div",{class:"text-xs text-gray-500 mb-1"},"Start Date",-1)),t("div",it,a(k(o.value.start_date)),1)]),t("div",ct,[e[5]||(e[5]=t("div",{class:"text-xs text-gray-500 mb-1"},"End Date",-1)),t("div",dt,a(k(o.value.end_date)),1)]),o.value.project_manager?(n(),r("div",ut,[e[6]||(e[6]=t("div",{class:"text-xs text-gray-500 mb-1"},"Manager",-1)),t("div",pt,a(o.value.project_manager),1)])):h("",!0),o.value.budget_amount?(n(),r("div",_t,[e[7]||(e[7]=t("div",{class:"text-xs text-gray-500 mb-1"},"Budget",-1)),t("div",mt,a(E(o.value.budget_amount)),1)])):h("",!0)]),t("div",vt,[t("div",ft,[t("span",null,"Tasks ("+a(u.value.length)+")",1)]),u.value.length===0?(n(),r("div",gt," No tasks for this project ")):(n(),r("div",ht,[(n(!0),r(T,null,M(u.value,l=>(n(),r("div",{key:l.name,class:"app-list-item",onClick:Tt=>V(l.name)},[t("div",xt,[t("div",jt,a(l.title||l.name),1),t("div",kt,"Due: "+a(k(l.due_date)),1)]),t("span",{class:N(["status-badge",w(l.status)])},a(l.status),3)],8,yt))),128))]))]),i.value.length>0?(n(),r("div",It,[t("div",bt,[t("span",null,"Team ("+a(i.value.length)+")",1)]),t("div",null,[(n(!0),r(T,null,M(i.value,l=>(n(),r("div",{key:l.name,class:"app-list-item"},[t("div",Ct,[t("div",Rt,[t("span",wt,a(F(l.employee_name)),1)]),t("div",null,[t("div",Dt,a(l.employee_name),1),t("div",Bt,a(l.role),1)])]),t("div",Nt,a(l.allocation_percentage)+"%",1)]))),128))])])):h("",!0)])):h("",!0)]),_:1})]),_:1}))}};export{Ft as default};
//# sourceMappingURL=ProjectDetail-i9rFKWMO.js.map
