{"version":3,"file":"TaskDetail-CcMADYCi.js","sources":["../../../../frontend/src/views/TaskDetail.vue"],"sourcesContent":["<template>\n  <ion-page>\n    <ion-header>\n      <ion-toolbar>\n        <ion-buttons slot=\"start\">\n          <ion-back-button default-href=\"/smart-pro/tasks\"></ion-back-button>\n        </ion-buttons>\n        <ion-title>Task Details</ion-title>\n        <ion-buttons slot=\"end\">\n          <ion-button @click=\"openActions\">\n            <ion-icon :icon=\"ellipsisVertical\"></ion-icon>\n          </ion-button>\n        </ion-buttons>\n      </ion-toolbar>\n    </ion-header>\n\n    <ion-content :fullscreen=\"true\">\n      <ion-refresher slot=\"fixed\" @ionRefresh=\"handleRefresh\">\n        <ion-refresher-content></ion-refresher-content>\n      </ion-refresher>\n\n      <!-- Loading State -->\n      <div v-if=\"loading\" class=\"p-4\">\n        <div class=\"skeleton h-8 w-3/4 mb-4\"></div>\n        <div class=\"skeleton h-4 w-1/2 mb-6\"></div>\n        <div class=\"skeleton h-24 w-full mb-4\"></div>\n      </div>\n\n      <!-- Error State -->\n      <div v-else-if=\"error\" class=\"empty-state h-full\">\n        <div class=\"empty-state-title\">Error loading task</div>\n        <div class=\"empty-state-description\">{{ error }}</div>\n        <ion-button class=\"mt-4\" @click=\"loadData\">Retry</ion-button>\n      </div>\n\n      <!-- Task Details -->\n      <div v-else-if=\"task\" class=\"p-4\">\n        <!-- Header -->\n        <div class=\"mb-6\">\n          <div class=\"flex justify-between items-start mb-2\">\n            <h1 class=\"text-2xl font-bold text-gray-800 flex-1 pr-2\">{{ task.title }}</h1>\n            <span :class=\"['status-badge', getStatusClass(task.status)]\">\n              {{ task.status }}\n            </span>\n          </div>\n          <p v-if=\"task.description\" class=\"text-gray-600\">\n            {{ task.description }}\n          </p>\n        </div>\n\n        <!-- Progress -->\n        <div class=\"app-card p-4 mb-6\">\n          <div class=\"flex justify-between items-center mb-2\">\n            <span class=\"font-medium\">Progress</span>\n            <span class=\"text-primary-600 font-bold\">{{ task.progress || 0 }}%</span>\n          </div>\n          <div class=\"progress-bar h-3\">\n            <div\n              class=\"progress-bar-fill\"\n              :style=\"{ width: (task.progress || 0) + '%' }\"\n            ></div>\n          </div>\n          <ion-button\n            expand=\"block\"\n            fill=\"outline\"\n            class=\"mt-4\"\n            @click=\"updateProgress\"\n          >\n            Update Progress\n          </ion-button>\n        </div>\n\n        <!-- Info Cards -->\n        <div class=\"grid grid-cols-2 gap-4 mb-6\">\n          <div class=\"app-card p-4\">\n            <div class=\"text-xs text-gray-500 mb-1\">Project</div>\n            <div class=\"font-medium text-primary-600\" @click=\"goToProject\">\n              {{ task.project || \"-\" }}\n            </div>\n          </div>\n          <div class=\"app-card p-4\">\n            <div class=\"text-xs text-gray-500 mb-1\">Due Date</div>\n            <div class=\"font-medium\" :class=\"{ 'text-red-600': isOverdue }\">\n              {{ formatDate(task.due_date) }}\n            </div>\n          </div>\n          <div class=\"app-card p-4\">\n            <div class=\"text-xs text-gray-500 mb-1\">Priority</div>\n            <div :class=\"['font-medium', getPriorityClass(task.priority)]\">\n              {{ task.priority || \"Normal\" }}\n            </div>\n          </div>\n          <div class=\"app-card p-4\">\n            <div class=\"text-xs text-gray-500 mb-1\">Assigned To</div>\n            <div class=\"font-medium\">{{ task.assigned_to || \"-\" }}</div>\n          </div>\n        </div>\n\n        <!-- Actions -->\n        <div class=\"space-y-3\">\n          <ion-button\n            v-if=\"task.status !== 'Completed'\"\n            expand=\"block\"\n            @click=\"markComplete\"\n          >\n            Mark as Complete\n          </ion-button>\n          <ion-button\n            v-if=\"task.status === 'Open'\"\n            expand=\"block\"\n            fill=\"outline\"\n            @click=\"startWorking\"\n          >\n            Start Working\n          </ion-button>\n        </div>\n      </div>\n    </ion-content>\n  </ion-page>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted, inject } from \"vue\"\nimport { useRoute, useRouter } from \"vue-router\"\nimport {\n  IonPage,\n  IonHeader,\n  IonToolbar,\n  IonTitle,\n  IonContent,\n  IonButtons,\n  IonBackButton,\n  IonButton,\n  IonIcon,\n  IonRefresher,\n  IonRefresherContent,\n  actionSheetController,\n  alertController,\n  loadingController,\n  toastController,\n} from \"@ionic/vue\"\nimport { ellipsisVertical } from \"ionicons/icons\"\nimport { call } from \"frappe-ui\"\n\nconst route = useRoute()\nconst router = useRouter()\nconst $dayjs = inject(\"$dayjs\")\n\nconst loading = ref(true)\nconst error = ref(\"\")\nconst task = ref(null)\n\nconst isOverdue = computed(() => {\n  if (!task.value?.due_date) return false\n  return $dayjs(task.value.due_date).isBefore($dayjs(), \"day\")\n})\n\nasync function loadData() {\n  const taskId = route.params.id\n  if (!taskId) {\n    error.value = \"Task not found\"\n    return\n  }\n\n  loading.value = true\n  error.value = \"\"\n\n  try {\n    const result = await call(\"frappe.client.get\", {\n      doctype: \"Smart Task\",\n      name: taskId,\n    })\n    task.value = result\n  } catch (err) {\n    console.error(\"Error loading task:\", err)\n    error.value = err.message || \"Failed to load task\"\n  } finally {\n    loading.value = false\n  }\n}\n\nfunction handleRefresh(event) {\n  loadData().finally(() => {\n    event.target.complete()\n  })\n}\n\nfunction formatDate(dateStr) {\n  if (!dateStr) return \"-\"\n  return $dayjs(dateStr).format(\"MMM D, YYYY\")\n}\n\nfunction getStatusClass(status) {\n  const map = {\n    Open: \"planning\",\n    Working: \"on-hold\",\n    \"Pending Review\": \"on-hold\",\n    Completed: \"completed\",\n    Cancelled: \"cancelled\",\n  }\n  return map[status] || \"\"\n}\n\nfunction getPriorityClass(priority) {\n  const map = {\n    Low: \"text-green-600\",\n    Medium: \"text-blue-600\",\n    High: \"text-orange-600\",\n    Critical: \"text-red-600\",\n  }\n  return map[priority] || \"text-gray-600\"\n}\n\nfunction goToProject() {\n  if (task.value?.project) {\n    router.push(`/smart-pro/project/${encodeURIComponent(task.value.project)}`)\n  }\n}\n\nasync function updateProgress() {\n  const alert = await alertController.create({\n    header: \"Update Progress\",\n    inputs: [\n      {\n        name: \"progress\",\n        type: \"number\",\n        placeholder: \"Enter progress (0-100)\",\n        min: 0,\n        max: 100,\n        value: task.value?.progress || 0,\n      },\n    ],\n    buttons: [\n      { text: \"Cancel\", role: \"cancel\" },\n      {\n        text: \"Update\",\n        handler: async (data) => {\n          const progress = Math.min(100, Math.max(0, parseInt(data.progress) || 0))\n          await saveTask({ progress })\n        },\n      },\n    ],\n  })\n  await alert.present()\n}\n\nasync function startWorking() {\n  await saveTask({ status: \"Working\" })\n}\n\nasync function markComplete() {\n  const alert = await alertController.create({\n    header: \"Mark Complete\",\n    message: \"Are you sure you want to mark this task as complete?\",\n    buttons: [\n      { text: \"Cancel\", role: \"cancel\" },\n      {\n        text: \"Complete\",\n        handler: async () => {\n          await saveTask({ status: \"Completed\", progress: 100 })\n        },\n      },\n    ],\n  })\n  await alert.present()\n}\n\nasync function saveTask(updates) {\n  const loader = await loadingController.create({ message: \"Saving...\" })\n  await loader.present()\n\n  try {\n    await call(\"frappe.client.set_value\", {\n      doctype: \"Smart Task\",\n      name: task.value.name,\n      fieldname: updates,\n    })\n\n    // Update local state\n    Object.assign(task.value, updates)\n\n    const toast = await toastController.create({\n      message: \"Task updated successfully\",\n      duration: 2000,\n      color: \"success\",\n    })\n    await toast.present()\n  } catch (err) {\n    console.error(\"Error saving task:\", err)\n    const toast = await toastController.create({\n      message: \"Failed to update task\",\n      duration: 2000,\n      color: \"danger\",\n    })\n    await toast.present()\n  } finally {\n    await loader.dismiss()\n  }\n}\n\nasync function openActions() {\n  const actionSheet = await actionSheetController.create({\n    header: \"Actions\",\n    buttons: [\n      {\n        text: \"Open in Desktop\",\n        handler: () => {\n          window.open(`/app/smart-task/${task.value.name}`, \"_blank\")\n        },\n      },\n      {\n        text: \"Cancel\",\n        role: \"cancel\",\n      },\n    ],\n  })\n  await actionSheet.present()\n}\n\nonMounted(() => {\n  loadData()\n})\n</script>\n"],"names":["route","useRoute","router","useRouter","$dayjs","inject","loading","ref","error","task","isOverdue","computed","_a","loadData","__async","taskId","result","call","err","handleRefresh","event","formatDate","dateStr","getStatusClass","status","getPriorityClass","priority","goToProject","updateProgress","alertController","data","progress","saveTask","startWorking","markComplete","updates","loader","loadingController","toastController","openActions","actionSheetController","onMounted","_createBlock","_unref","IonPage","_createVNode","IonHeader","IonToolbar","IonButtons","IonBackButton","IonTitle","_cache","IonButton","IonIcon","ellipsisVertical","IonContent","IonRefresher","IonRefresherContent","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_toDisplayString","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_normalizeClass","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_normalizeStyle","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19"],"mappings":"wsCAgJA,MAAMA,EAAQC,EAAQ,EAChBC,EAASC,EAAS,EAClBC,EAASC,EAAO,QAAQ,EAExBC,EAAUC,EAAI,EAAI,EAClBC,EAAQD,EAAI,EAAE,EACdE,EAAOF,EAAI,IAAI,EAEfG,EAAYC,EAAS,IAAM,OAC/B,OAAKC,EAAAH,EAAK,QAAL,MAAAG,EAAY,SACVR,EAAOK,EAAK,MAAM,QAAQ,EAAE,SAASL,EAAM,EAAI,KAAK,EADzB,EAEpC,CAAC,EAED,SAAeS,GAAW,QAAAC,EAAA,sBACxB,MAAMC,EAASf,EAAM,OAAO,GAC5B,GAAI,CAACe,EAAQ,CACXP,EAAM,MAAQ,iBACd,MACF,CAEAF,EAAQ,MAAQ,GAChBE,EAAM,MAAQ,GAEd,GAAI,CACF,MAAMQ,EAAS,MAAMC,EAAK,oBAAqB,CAC7C,QAAS,aACT,KAAMF,CACZ,CAAK,EACDN,EAAK,MAAQO,CACf,OAASE,EAAK,CACZ,QAAQ,MAAM,sBAAuBA,CAAG,EACxCV,EAAM,MAAQU,EAAI,SAAW,qBAC/B,QAAC,CACCZ,EAAQ,MAAQ,EAClB,CACF,GAEA,SAASa,EAAcC,EAAO,CAC5BP,EAAQ,EAAG,QAAQ,IAAM,CACvBO,EAAM,OAAO,SAAQ,CACvB,CAAC,CACH,CAEA,SAASC,EAAWC,EAAS,CAC3B,OAAKA,EACElB,EAAOkB,CAAO,EAAE,OAAO,aAAa,EADtB,GAEvB,CAEA,SAASC,EAAeC,EAAQ,CAQ9B,MAPY,CACV,KAAM,WACN,QAAS,UACT,iBAAkB,UAClB,UAAW,YACX,UAAW,WACf,EACaA,CAAM,GAAK,EACxB,CAEA,SAASC,EAAiBC,EAAU,CAOlC,MANY,CACV,IAAK,iBACL,OAAQ,gBACR,KAAM,kBACN,SAAU,cACd,EACaA,CAAQ,GAAK,eAC1B,CAEA,SAASC,GAAc,QACjBf,EAAAH,EAAK,QAAL,MAAAG,EAAY,SACdV,EAAO,KAAK,sBAAsB,mBAAmBO,EAAK,MAAM,OAAO,CAAC,EAAE,CAE9E,CAEA,SAAemB,GAAiB,QAAAd,EAAA,4BAwB9B,MAvBc,MAAMe,EAAgB,OAAO,CACzC,OAAQ,kBACR,OAAQ,CACN,CACE,KAAM,WACN,KAAM,SACN,YAAa,yBACb,IAAK,EACL,IAAK,IACL,QAAOjB,EAAAH,EAAK,QAAL,YAAAG,EAAY,WAAY,CACvC,CACA,EACI,QAAS,CACP,CAAE,KAAM,SAAU,KAAM,QAAQ,EAChC,CACE,KAAM,SACN,QAAgBkB,GAAShB,EAAA,sBACvB,MAAMiB,EAAW,KAAK,IAAI,IAAK,KAAK,IAAI,EAAG,SAASD,EAAK,QAAQ,GAAK,CAAC,CAAC,EACxE,MAAME,EAAS,CAAE,SAAAD,CAAQ,CAAE,CAC7B,EACR,CACA,CACA,CAAG,GACW,QAAO,CACrB,GAEA,SAAeE,GAAe,QAAAnB,EAAA,sBAC5B,MAAMkB,EAAS,CAAE,OAAQ,SAAS,CAAE,CACtC,GAEA,SAAeE,GAAe,QAAApB,EAAA,sBAc5B,MAbc,MAAMe,EAAgB,OAAO,CACzC,OAAQ,gBACR,QAAS,uDACT,QAAS,CACP,CAAE,KAAM,SAAU,KAAM,QAAQ,EAChC,CACE,KAAM,WACN,QAAS,IAAYf,EAAA,sBACnB,MAAMkB,EAAS,CAAE,OAAQ,YAAa,SAAU,GAAG,CAAE,CACvD,EACR,CACA,CACA,CAAG,GACW,QAAO,CACrB,GAEA,SAAeA,EAASG,EAAS,QAAArB,EAAA,sBAC/B,MAAMsB,EAAS,MAAMC,GAAkB,OAAO,CAAE,QAAS,WAAW,CAAE,EACtE,MAAMD,EAAO,QAAO,EAEpB,GAAI,CACF,MAAMnB,EAAK,0BAA2B,CACpC,QAAS,aACT,KAAMR,EAAK,MAAM,KACjB,UAAW0B,CACjB,CAAK,EAGD,OAAO,OAAO1B,EAAK,MAAO0B,CAAO,EAOjC,MALc,MAAMG,EAAgB,OAAO,CACzC,QAAS,4BACT,SAAU,IACV,MAAO,SACb,CAAK,GACW,QAAO,CACrB,OAASpB,EAAK,CACZ,QAAQ,MAAM,qBAAsBA,CAAG,EAMvC,MALc,MAAMoB,EAAgB,OAAO,CACzC,QAAS,wBACT,SAAU,IACV,MAAO,QACb,CAAK,GACW,QAAO,CACrB,QAAC,CACC,MAAMF,EAAO,QAAO,CACtB,CACF,GAEA,SAAeG,GAAc,QAAAzB,EAAA,sBAgB3B,MAfoB,MAAM0B,GAAsB,OAAO,CACrD,OAAQ,UACR,QAAS,CACP,CACE,KAAM,kBACN,QAAS,IAAM,CACb,OAAO,KAAK,mBAAmB/B,EAAK,MAAM,IAAI,GAAI,QAAQ,CAC5D,CACR,EACM,CACE,KAAM,SACN,KAAM,QACd,CACA,CACA,CAAG,GACiB,QAAO,CAC3B,GAEA,OAAAgC,EAAU,IAAM,CACd5B,EAAQ,CACV,CAAC,cAhUC6B,EAqHWC,EAAAC,EAAA,EAAA,KAAA,WApHT,IAYa,CAZbC,EAYaF,EAAAG,CAAA,EAAA,KAAA,WAXX,IAUc,CAVdD,EAUcF,EAAAI,CAAA,EAAA,KAAA,WATZ,IAEc,CAFdF,EAEcF,EAAAK,CAAA,EAAA,CAFD,KAAK,OAAO,EAAA,WACvB,IAAmE,CAAnEH,EAAmEF,EAAAM,CAAA,EAAA,CAAlD,eAAa,kBAAkB,CAAA,UAElDJ,EAAmCF,EAAAO,CAAA,EAAA,KAAA,WAAxB,IAAY,CAAA,GAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAZ,eAAY,EAAA,YACvBN,EAIcF,EAAAK,CAAA,EAAA,CAJD,KAAK,KAAK,EAAA,WACrB,IAEa,CAFbH,EAEaF,EAAAS,CAAA,EAAA,CAFA,QAAOb,CAAW,EAAA,WAC7B,IAA8C,CAA9CM,EAA8CF,EAAAU,CAAA,EAAA,CAAnC,KAAMV,EAAAW,EAAA,GAAgB,KAAA,EAAA,CAAA,MAAA,CAAA,kCAMzCT,EAqGcF,EAAAY,CAAA,EAAA,CArGA,WAAY,EAAI,EAAA,WAC5B,IAEgB,CAFhBV,EAEgBF,EAAAa,CAAA,EAAA,CAFD,KAAK,QAAS,aAAYrC,cACvC,IAA+C,CAA/C0B,EAA+CF,EAAAc,EAAA,CAAA,UAItCnD,EAAA,OAAXoD,IAAAC,EAIM,MAJNC,GAIM,CAAA,GAAAT,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CAHJU,EAA2C,MAAA,CAAtC,MAAM,yBAAyB,EAAA,KAAA,EAAA,EACpCA,EAA2C,MAAA,CAAtC,MAAM,yBAAyB,EAAA,KAAA,EAAA,EACpCA,EAA6C,MAAA,CAAxC,MAAM,2BAA2B,EAAA,KAAA,EAAA,OAIxBrD,EAAA,OAAhBkD,IAAAC,EAIM,MAJNG,GAIM,CAHJX,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAU,EAAuD,MAAA,CAAlD,MAAM,mBAAmB,EAAC,qBAAkB,EAAA,GACjDA,EAAsD,MAAtDE,GAAsDC,EAAdxD,EAAA,KAAK,EAAA,CAAA,EAC7CqC,EAA6DF,EAAAS,CAAA,EAAA,CAAjD,MAAM,OAAQ,QAAOvC,cAAU,IAAK,CAAA,GAAAsC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAL,QAAK,EAAA,eAIlC1C,EAAA,OAAhBiD,IAAAC,EAgFM,MAhFNM,GAgFM,CA9EJJ,EAUM,MAVNK,GAUM,CATJL,EAKM,MALNM,GAKM,CAJJN,EAA8E,KAA9EO,GAA8EJ,EAAlBvD,EAAA,MAAK,KAAK,EAAA,CAAA,EACtEoD,EAEO,OAAA,CAFA,MAAKQ,EAAA,CAAA,eAAmB9C,EAAed,EAAA,MAAK,MAAM,CAAA,CAAA,CACpD,EAAAuD,EAAAvD,EAAA,MAAK,MAAM,EAAA,CAAA,IAGTA,EAAA,MAAK,aAAdiD,EAAA,EAAAC,EAEI,IAFJW,GAEIN,EADCvD,EAAA,MAAK,WAAW,EAAA,CAAA,cAKvBoD,EAmBM,MAnBNU,GAmBM,CAlBJV,EAGM,MAHNW,GAGM,CAFJrB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAU,EAAyC,OAAA,CAAnC,MAAM,aAAa,EAAC,WAAQ,EAAA,GAClCA,EAAyE,OAAzEY,GAAyET,EAA7BvD,QAAK,aAAgB,IAAC,CAAA,IAEpEoD,EAKM,MALNa,GAKM,CAJJb,EAGO,MAAA,CAFL,MAAM,oBACL,MAAKc,EAAA,CAAA,OAAYlE,EAAA,MAAK,UAAQ,GAAA,GAAA,CAAA,aAGnCoC,EAOaF,EAAAS,CAAA,EAAA,CANX,OAAO,QACP,KAAK,UACL,MAAM,OACL,QAAOxB,cACT,IAED,CAAA,GAAAuB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAFC,oBAED,EAAA,cAIFU,EAuBM,MAvBNe,GAuBM,CAtBJf,EAKM,MALNgB,GAKM,CAJJ1B,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAU,EAAqD,MAAA,CAAhD,MAAM,4BAA4B,EAAC,UAAO,EAAA,GAC/CA,EAEM,MAAA,CAFD,MAAM,+BAAgC,QAAOlC,CAC7C,EAAAqC,EAAAvD,EAAA,MAAK,SAAO,GAAA,EAAA,CAAA,IAGnBoD,EAKM,MALNiB,GAKM,CAJJ3B,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAU,EAAsD,MAAA,CAAjD,MAAM,4BAA4B,EAAC,WAAQ,EAAA,GAChDA,EAEM,MAAA,CAFD,MAAKQ,EAAA,CAAC,cAAa,CAAA,eAA2B3D,EAAA,MAAS,CAAA,KACvDW,EAAWZ,EAAA,MAAK,QAAQ,CAAA,EAAA,CAAA,IAG/BoD,EAKM,MALNkB,GAKM,CAJJ5B,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAU,EAAsD,MAAA,CAAjD,MAAM,4BAA4B,EAAC,WAAQ,EAAA,GAChDA,EAEM,MAAA,CAFA,MAAKQ,EAAA,CAAA,cAAkB5C,EAAiBhB,EAAA,MAAK,QAAQ,CAAA,CAAA,CACtD,EAAAuD,EAAAvD,EAAA,MAAK,UAAQ,QAAA,EAAA,CAAA,IAGpBoD,EAGM,MAHNmB,GAGM,CAFJ7B,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAU,EAAyD,MAAA,CAApD,MAAM,4BAA4B,EAAC,cAAW,EAAA,GACnDA,EAA4D,MAA5DoB,GAA4DjB,EAAhCvD,EAAA,MAAK,aAAW,GAAA,EAAA,CAAA,MAKhDoD,EAgBM,MAhBNqB,GAgBM,CAdIzE,EAAA,MAAK,SAAM,iBADnBiC,EAMaC,EAAAS,CAAA,EAAA,OAJX,OAAO,QACN,QAAOlB,cACT,IAED,CAAA,GAAAiB,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAA,GAFC,qBAED,EAAA,sBAEQ1C,EAAA,MAAK,SAAM,YADnBiC,EAOaC,EAAAS,CAAA,EAAA,OALX,OAAO,QACP,KAAK,UACJ,QAAOnB,cACT,IAED,CAAA,GAAAkB,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAA,GAFC,kBAED,EAAA"}